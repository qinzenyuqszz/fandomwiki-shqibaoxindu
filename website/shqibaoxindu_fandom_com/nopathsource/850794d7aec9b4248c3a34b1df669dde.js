var Tt=Object.defineProperty;var Ae=i=>{throw TypeError(i)};var It=(i,n,e)=>n in i?Tt(i,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[n]=e;var o=(i,n,e)=>It(i,typeof n!="symbol"?n+"":n,e),Te=(i,n,e)=>n.has(i)||Ae("Cannot "+e);var V=(i,n,e)=>(Te(i,n,"read from private field"),e?e.call(i):n.get(i)),ne=(i,n,e)=>n.has(i)?Ae("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(i):n.set(i,e),G=(i,n,e,t)=>(Te(i,n,"write to private field"),t?t.call(i,e):n.set(i,e),e);function He(){return"v54"}function _t(i){i.cmd??(i.cmd=[]);const n=[...i.cmd];i.cmd.push=(...e)=>{for(const t of e)t(i);return 0};for(const e of n)e(i)}const wt=i=>{const n=("; "+document.cookie).split("; "+i+"=");return n.length>=2?n.pop().split(";").shift():null},qe=i=>i!=null&&i.length?` domain=${i};`:"",vt=(i,n,e)=>{const t=new Date;t.setTime(t.getTime()+e.expires*1e3),document.cookie=`${i}=${n};${qe(e.domain)} path=${e.path}; expires=${t.toUTCString()}`},yt=(i,n)=>{document.cookie=`${i}=;${qe(n.domain)} path=${n.path}; expires=Thu, 01 Jan 1970 00:00:00 GMT`},y={set:vt,get:wt,delete:yt},$e=()=>{const i=window.location.hostname,n=i.split(".");return n.length<2?i:`.${n[n.length-2]}.${n[n.length-1]}`};function Ct(){const i=window.location.hostname.toLowerCase(),n=/(^|.)(showcase|externaltest|preview|verify|stable|sandbox-[^.]+)\./.exec(i);if(n&&n.length>2)return n[2];const[e]=i.split(".");return e||null}function Ke(i){return new URLSearchParams(window.location.search).get(i)}function x(i){const n=Ke(i);return j(i)&&n===""||n==="1"||n==="true"}function j(i){return new URLSearchParams(window.location.search).has(i)}const Pt="100",Rt=/^(?:v\d+-)?(\d{2})$/;function Nt(){let i=Ke("pf_pathfinder_force_bucket")??y.get("exp_bucket");const n=i==null?void 0:i.match(Rt);return n&&n.length>=2&&(i=n[1]),i??Pt}function Lt(i,n){var e;if(typeof n=="string"){const t=document.getElementsByTagName("script")[0];(e=t==null?void 0:t.parentNode)==null||e.insertBefore(i,t)}else(n??document.body).appendChild(i)}const Ot={isAsyncOrDeferOtherwise:!0,node:null,parameters:{},datasets:{}};function kt(i){const{src:n,isAsyncOrDeferOtherwise:e,node:t,parameters:r,datasets:s}={...Ot,...i},a=document.createElement("script");return a.async=!!e,a.defer=!e,a.src=n,r&&Object.keys(r).forEach(d=>{a.setAttribute(d,r[d])}),s&&Object.keys(s).forEach(d=>{a.dataset[d]=s[d]}),Lt(a,t),a}async function I(i){return new Promise((n,e)=>{const t=kt(typeof i=="string"?{src:i,node:null}:i);t.onload=n,t.onerror=e})}function f(i,n){window.fandomTrack=window.fandomTrack??{q:[]},window.fandomTrack.q.push({event:i,payload:n})}class Bt{constructor(){o(this,"storage",{})}get length(){return Object.keys(this.storage).length}key(n){return Object.keys(this.storage)[n]}clear(){this.storage={}}getItem(n){var e;return((e=this.storage)==null?void 0:e[n])??null}removeItem(n){delete this.storage[n]}setItem(n,e){this.storage[n]=e}}function Ye(i){return i instanceof Object&&"expires"in i&&"data"in i&&typeof i.expires=="number"}function Dt(i){return Ye(i)&&i.expires?Date.now()>=i.expires:!1}class Qe{constructor(n=()=>window.localStorage){o(this,"fallbackStorage",new Bt);o(this,"provider");try{this.provider=n(),this.isAvailable()||(this.provider=this.fallbackStorage)}catch{this.provider=this.fallbackStorage}}isAvailable(){const n=`__o${Date.now()}__`;try{this.provider.setItem(n,n);const e=this.provider.getItem(n)==n;return this.provider.removeItem(n),e}catch{return!1}}getItem(n,e=!1){try{let t=this.provider.getItem(n);return t===null||e?t:(t=this.parseValue(t),Ye(t)?this.handleTTLItem(n,t):t)}catch{return this.fallbackStorage.getItem(n)}}parseValue(n){try{return JSON.parse(n)}catch{return n}}handleTTLItem(n,e){return Dt(e)?(this.removeItem(n),null):e.data}setItemWithTTL(n,e,t){const s={expires:Date.now()+t,data:e};return this.setItem(n,s)}setItem(n,e,t){if(t)return this.setItemWithTTL(n,e,t);const r=e instanceof Object?JSON.stringify(e):e;try{this.provider.setItem(n,r)}catch{this.fallbackStorage.setItem(n,r)}return!0}removeItem(n){try{this.provider.removeItem(n)}catch{this.fallbackStorage.removeItem(n)}}clear(){try{this.provider.clear()}catch{this.fallbackStorage.clear()}}}function Y(i,n={maxTries:100,fixedTimeout:0}){return(async()=>{let t=0,r="exponentialTimeout"in n?n.exponentialTimeout:n.fixedTimeout,s=i();for(;!s&&t<n.maxTries;)await new Promise(a=>setTimeout(a,r)),s=i(),"exponentialTimeout"in n&&(r*=2),t++;return s})()}function Ft(i,n){return new Promise((e,t)=>{setTimeout(()=>{let r=`Operation timed out after ${i}ms`;n&&(r=`${n} ${r}`),t(new Error(r))},i)})}function U(i,n,e){const t=Ft(n,e),r=Array.isArray(i)?Promise.all(i):i;return Promise.race([r,t])}function Mt(i=[],n){const e=i.flat().filter(t=>t.status==="rejected");if(e.length>0){for(const r of e)console.warn(r.reason);let t=`${e.length} of ${i.length} promises were rejected.`;n&&(t=`${n} ${t}`),console.warn(t,e)}}async function Ie(i,n,e){const t=await U(Promise.allSettled(i),n,e);return Mt(t,e),t}const xt="unknown";function Ut(){var i;return((i=window.RLCONF)==null?void 0:i.wgCityId)??xt}var b=(i=>(i.AE_FIRST_LINE_EXEC="ae.firstLineExec",i.AE_AFTER_INIT_PLUGINS="ae.afterInitPlugins",i.AE_AFTER_GPT_WRAPPER_INIT="ae.afterGptWrapperInit",i.AE_AD_ENGINE_INIT="ae.adEngineInit",i.AE_ON_BIDDERS_INIT="ae.onBiddersInit",i.AE_CONFIG_CALLBACK_STARTED="ae.beforeAuction.configCallbackStarted",i.AE_CONFIG_CALLBACK_COMPLETE="ae.beforeAuction.configCallbackComplete",i.AE_AUCTION_START="ae.auctionStart",i.AE_AUCTION_START_A9_START="ae.auctionStart.a9.bidStart",i.AE_AUCTION_END="ae.auctionEnd",i.AE_BEFORE_FIRST_CALL_ADS_REQUEST="ae.beforeFirstCallAdsRequest",i.AE_GPT_SLOT_REQUESTED_INITIAL="ae.gpt.slotRequested.initial",i.AE_GPT_SLOT_RESPONSE_RECEIVED_INITIAL="ae.gpt.slotResponseReceived.initial",i.AE_GPT_SLOT_RENDERED_ENDED_INITIAL="ae.gpt.slotRenderEnded.initial",i.AE_GPT_SLOT_SLOT_ONLOAD_INITIAL="ae.gpt.slotOnload.initial",i))(b||{}),Xe=(i=>(i.AE_AUCTION_DURATION_A9_BID_TOTAL_TIME="ae.d.auctionDuration.a9.bidTotalTime",i.AE_AUCTION_DURATION="ae.d.auctionDuration",i.AE_DURATION_TO_BID="ae.d.firstLineExec_to_auctionStart",i.AE_CONFIG_CALLBACK_DURATION="ae.d.configCallbackDuration",i))(Xe||{}),w=(i=>(i.BIDDER_RESPONSE="bid_response",i))(w||{}),R=(i=>(i.SLOT_REQUESTED_INFO="requested_info",i.SLOT_CODE_SERVED_INFO="code_served_info",i.SLOT_RENDERED_INFO="success_info",i.SLOT_COLLAPSE_INFO="collapse",i.SLOT_FORCE_CLOSE_INFO="force-close",i.SLOT_CLICKED="clicked",i))(R||{}),Je=(i=>(i.LABRADOR_KEYVALUES="labrador_keyvalues",i))(Je||{}),F=(i=>(i.SLOT_REQUESTED="requested",i.SLOT_RENDERED="rendered",i.AE_INIT="init",i.VENDOR_TIME_UPDATE="vendor_time_update",i))(F||{}),Ze=(i=>(i.SLOT_SIZE_ESTABLISHED="size_established",i))(Ze||{}),L;class Wt{constructor(n,e=[]){ne(this,L);o(this,"version");this.cmd=e,G(this,L,n),this.version=He(),window.fandomAds=this,_t(this)}getPlugin(n){if(!V(this,L)[n])throw new Error(`Plugin ${n} does not exist`);return V(this,L)[n].api}}L=new WeakMap;function Vt(){return new Promise(i=>{window.fandomSentry?i(window.fandomSentry):window.addEventListener("fandomSentryLoaded",()=>{i(window.fandomSentry)})})}async function et(i){(await Vt()).captureException(i)}const Gt=function(){const n=typeof document<"u"&&document.createElement("link").relList;return n&&n.supports&&n.supports("modulepreload")?"modulepreload":"preload"}(),zt=function(i){return"/"+i},_e={},S=function(n,e,t){let r=Promise.resolve();if(e&&e.length>0){let a=function(l){return Promise.all(l.map(m=>Promise.resolve(m).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),c=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));r=a(e.map(l=>{if(l=zt(l),l in _e)return;_e[l]=!0;const m=l.endsWith(".css"),g=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${g}`))return;const p=document.createElement("link");if(p.rel=m?"stylesheet":Gt,m||(p.as="script"),p.crossOrigin="",p.href=l,c&&p.setAttribute("nonce",c),document.head.appendChild(p),m)return new Promise((te,B)=>{p.addEventListener("load",te),p.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=a,window.dispatchEvent(d),!d.defaultPrevented)throw a}return r.then(a=>{for(const d of a||[])d.status==="rejected"&&s(d.reason);return n().catch(s)})};function jt(){var i,n,e;return((e=(n=(i=window.ads)==null?void 0:i.context)==null?void 0:n.opts)==null?void 0:e.isAdTestWiki)===!0}async function Ht(){const i=[];if(j("cid")){const{PassCIDPlugin:r}=await S(async()=>{const{PassCIDPlugin:s}=await import("./PassCIDPlugin-NIt22ysi.js");return{PassCIDPlugin:s}},[]);i.push(new r)}if(x("gpt_debug")){const{GPTDebugPlugin:r}=await S(async()=>{const{GPTDebugPlugin:s}=await import("./GPTDebugPlugin-BN8qV7vA.js");return{GPTDebugPlugin:s}},[]);i.push(new r)}if(j("wikia_bidder")||j("pbjs_mock")){const{PrebidWikiaDebugPlugin:r}=await S(async()=>{const{PrebidWikiaDebugPlugin:s}=await import("./PrebidWikiaDebugPlugin-DsNc0N0v.js");return{PrebidWikiaDebugPlugin:s}},[]);i.push(new r)}if(x("bidder_debug")){const{BidderDebugPlugin:r}=await S(async()=>{const{BidderDebugPlugin:s}=await import("./BidderDebugPlugin-B8A8Y1X9.js");return{BidderDebugPlugin:s}},[]);i.push(new r)}if(jt()){const{TestWikiPlugin:r}=await S(async()=>{const{TestWikiPlugin:s}=await import("./TestWikiPlugin-CJwZxu5w.js");return{TestWikiPlugin:s}},[]);i.push(new r)}return i}function qt(){var i;return(i=window.icbm)!=null&&i.config?Promise.resolve(window.icbm):new Promise(n=>{const e=()=>{n(window.icbm),window.removeEventListener("instantConfigLoaded",e)};window.addEventListener("instantConfigLoaded",e)})}var we="Invariant failed";function h(i,n){if(!i){var e=typeof n=="function"?n():n,t=e?"".concat(we,": ").concat(e):we;throw new Error(t)}}function v(){return window.fandomContext??null}function $t(i){var n;return(n=i==null?void 0:i.site)!=null&&n.top1000?"_top1k_wiki":"_not_a_top1k_wiki"}class Kt{constructor(n){o(this,"SERVER_PREFIX","wka1b");this.gptWrapper=n}buildAdUnitPathForNode(n){const e=v(),t=this.gptWrapper.getGamId(),{group:r}=n.getSlotConfig(),s=n.getSlotName(),a=$t(e),[d="fandom"]=this.gptWrapper.getTargeting("product"),[c="article"]=this.gptWrapper.getTargeting("s2"),[l="all"]=this.gptWrapper.getTargeting("s0"),[m="ucp_desktop"]=this.gptWrapper.getTargeting("skin"),[g="desktop"]=this.gptWrapper.getTargeting("device");return`/${t}/${this.SERVER_PREFIX}.${r}/${s}/${g}/${m}-${d}-${c}/${a}-${l}`}setupPerformanceMarks(n){n.addToCommandQueue(()=>{this.registerEventPerformanceMarkCallback(n,"slotRequested","top_leaderboard"),this.registerEventPerformanceMarkCallback(n,"slotResponseReceived","top_leaderboard"),this.registerEventPerformanceMarkCallback(n,"slotRenderEnded","top_leaderboard"),this.registerEventPerformanceMarkCallback(n,"slotOnload","top_leaderboard")})}registerEventPerformanceMarkCallback(n,e,t){n.addEventListener(e,({slot:r})=>{const s=r.getTargeting("rv");if(s.length>0&&s[0]==="1"&&r.getSlotElementId()===t){const d=this.getInitialSlotPerformanceMarkName(e);d&&performance.mark(d.toString(),{detail:{slotId:t}})}})}getInitialSlotPerformanceMarkName(n){switch(n){case"slotRequested":return b.AE_GPT_SLOT_REQUESTED_INITIAL;case"slotResponseReceived":return b.AE_GPT_SLOT_RESPONSE_RECEIVED_INITIAL;case"slotRenderEnded":return b.AE_GPT_SLOT_RENDERED_ENDED_INITIAL;case"slotOnload":return b.AE_GPT_SLOT_SLOT_ONLOAD_INITIAL}}}const ve="fs";class Yt{constructor(n,e){o(this,"GAM_ID","5441");o(this,"gptPlatformPlugin");this.initialPageTargeting=n,this.hooks=e,this.gptPlatformPlugin=new Kt(this),window.googletag=window.googletag??{cmd:[]},this.gptPlatformPlugin.setupPerformanceMarks(this)}async enableServices(){return new Promise(n=>{this.addToCommandQueue(()=>{googletag.pubads().disableInitialLoad(),googletag.pubads().enableSingleRequest(),googletag.pubads().enableVideoAds();for(const[e,t]of Object.entries(this.initialPageTargeting))this.setTargeting(e,t);googletag.enableServices(),n()})})}getGamId(){return this.GAM_ID}setConfig(n){this.addToCommandQueue(()=>{googletag.setConfig(n)})}setTargeting(n,e){if(typeof e=="string"||Array.isArray(e)){googletag.pubads().setTargeting(n,e);return}console.error(`Targeting value for key "${n}" must be a string or an array of strings, passed `,e)}getTargeting(n){return googletag.pubads().getTargeting(n)}clearTargeting(n){googletag.pubads().clearTargeting(n)}getAdUnitPath(n){const e=this.getGPTSlotsBySlotNames([n]);return e.length>=1?e[0].getAdUnitPath():null}getAllTargeting(n={}){const{raw:e=!1}=n,t={},r=googletag.pubads().getTargetingKeys();for(const s of r){const a=this.getTargeting(s);e||a.length>1?t[s]=a:a.length===1&&(t[s]=a[0])}return t}updatePublisherProvidedId(n){n&&this.addToCommandQueue(()=>{this.setTargeting("ppid",n),googletag.pubads().setPublisherProvidedId(n)})}updatePrivacySettings({consentApi:n,optOut:e,coppa:t}){var d,c;const r=n==="tcf"&&e?"1":"0",s=n==="usp"&&e?"1":"0",a=(c=(d=window.fandomContext)==null?void 0:d.site)==null?void 0:c.directedAtChildren;this.addToCommandQueue(()=>{a&&this.setTargeting("monetization",t?"restricted":"regular"),this.setTargeting("npa",r),this.setTargeting("rdp",s),googletag.pubads().setPrivacySettings({nonPersonalizedAds:r==="1",restrictDataProcessing:s==="1",childDirectedTreatment:t===!0})})}defineSlot(n){this.addToCommandQueue(()=>{const e=n.getSlotConfig(),t=this.gptPlatformPlugin.buildAdUnitPathForNode(n),r=googletag.defineSlot(t,e.sizes,e.name);if(r===null){console.warn("GptWrapper: Slot is null",e);return}Object.entries(e.targeting).forEach(([s,a])=>{r.setTargeting(s,a)}),e.responsiveSizes&&r.defineSizeMapping(e.responsiveSizes),r.addService(googletag.pubads()),e.companion&&r.addService(googletag.companionAds())})}getGPTSlotsByAdNodes(n){return this.getGPTSlotsBySlotNames(n.map(e=>e.getSlotName()))}getGPTSlotsBySlotNames(n){const e=new Set(n);return googletag.pubads().getSlots().filter(t=>e.has(t.getSlotElementId()))}addKeyValForTruncationCheck(){this.clearTargeting(ve),this.setTargeting(ve,"t")}requestSlots(n){this.hooks.onBeforeAdsRequest(this,n),this.addKeyValForTruncationCheck(),googletag.pubads().refresh(this.getGPTSlotsByAdNodes(n))}destroySlots(n){n&&googletag.destroySlots(this.getGPTSlotsByAdNodes(n))}setSlotTargeting(n,e,t){const[r]=this.getGPTSlotsBySlotNames([n]);h(r,`Slot ${n} not found`),r.setTargeting(e,t)}getSlotTargeting(n,e){const[t]=this.getGPTSlotsBySlotNames([n]);return h(t,`Slot ${n} not found`),t.getTargeting(e)}getAllSlotTargeting(n,e={}){const{raw:t=!0}=e,[r]=this.getGPTSlotsBySlotNames([n]);h(r,`Slot ${n} not found`);const s=r.getTargetingKeys();return Object.fromEntries(s.map(a=>{let d=r.getTargeting(a);return!t&&Array.isArray(d)&&d.length===1&&(d=d[0]),[a,d]}))}updateSizeMapping(n,e){const[t]=this.getGPTSlotsBySlotNames([n]);return h(t,`Slot ${n} not found`),t.defineSizeMapping(e)}addToCommandQueue(n){googletag.cmd.push(n)}addEventListener(n,e){googletag.pubads().addEventListener(n,e)}removeEventListener(n,e){googletag.pubads().removeEventListener(n,e)}addSlotEventListener(n,e,t){const r=s=>{s.slot.getSlotElementId()===n&&t(s)};return this.addEventListener(e,r),()=>this.removeEventListener(e,r)}}function T(i,n,...e){for(const t of i){const r=t.hooks[n];if(typeof r=="function")try{r.call(t,...e)}catch(s){console.error(`Error running hook ${n} in plugin ${t.constructor.name}`,s),et(s)}}}const Q=200,Qt=1;function tt(i,n=Q){if(!i)return!1;const{top:e,bottom:t}=i.getBoundingClientRect();return t>-n&&e<window.innerHeight+n}function Xt(i){return tt(i,0)}var pe=(i=>(i.EXACT="EXACT",i.LESS_THAN="LESS_THAN",i.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",i.GREATER_THAN="GREATER_THAN",i.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",i))(pe||{});const Jt={strategy:"once",match:"height",with:"GREATER_THAN"};function nt(i){switch(i){case"EXACT":return(n,e)=>n===e;case"LESS_THAN":return(n,e)=>n<e;case"LESS_THAN_OR_EQUAL":return(n,e)=>n<=e;case"GREATER_THAN":return(n,e)=>n>e;case"GREATER_THAN_OR_EQUAL":return(n,e)=>n>=e;default:throw new Error(`Invalid comparator: ${i}`)}}function it(i){return Array.isArray(i)&&i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"}function Zt(i){if(!it(i))return!1;if(i[0]===0&&i[1]===0)throw new Error("Invalid size to compare [0,0]");return!0}function ae(i,n,e="EXACT"){if(!it(i)||!Zt(n))return!1;const t=typeof e=="function"?e:nt(e),[r,s]=i,[a,d]=n;return a===0?t(s,d):d===0?t(r,a):t(r,a)&&t(s,d)}function z(i,n,e="EXACT"){if(!Array.isArray(i))return i;const t=nt(e);return i.filter(r=>!ae(r,n,t))}function en(i,n){for(const e of i)e.length===2&&e[1].push(n);return i}const tn=/_\d+$/;function rt(i){return i.replace(tn,"")}var st=(i=>(i.NOT_RENDERED="not-rendered",i.RENDERING="rendering",i.RENDERED="rendered",i))(st||{});class nn{constructor(n,e,t){o(this,"renderStatus","not-rendered");o(this,"renderCount",0);o(this,"currentSlotConfig");o(this,"emptyRetryCount",0);o(this,"blocked",!1);this.slotName=n,this.slotConfig=e,this.gptWrapper=t,this.currentSlotConfig=JSON.parse(JSON.stringify(e)),this.hookAdNodeToGptEvents()}hookAdNodeToGptEvents(){this.enableLimitingSizesIfConfigured(),this.listenToSlotRenderEnded()}enableLimitingSizesIfConfigured(){const n=this.getRefreshConfigRemoveSizes();if(!(n!=null&&n.strategy))return;const e=this.gptWrapper.addSlotEventListener(this.slotName,"impressionViewable",()=>{this.removeSizesFromSlotElement(),n.strategy==="once"&&e()})}listenToSlotRenderEnded(){this.gptWrapper.addSlotEventListener(this.slotName,"slotRenderEnded",n=>{this.renderStatus="rendered",n.isEmpty?this.emptyRetryCount+=1:this.emptyRetryCount=0})}destroy(){this.gptWrapper.destroySlots([this])}getSlotName(){return this.slotName}getBaseSlotName(){return rt(this.slotName)}getSlotType(){return this.currentSlotConfig.type??"display"}getSlotConfig(){return this.currentSlotConfig}setSlotConfig(n){this.currentSlotConfig=n}getBidderConfig(n){var e;return(e=this.currentSlotConfig.bidders)==null?void 0:e[n]}setBidderConfig(n,e){var t;(t=this.currentSlotConfig).bidders??(t.bidders={}),this.currentSlotConfig.bidders[n]=e}getElement(){return document.getElementById(this.slotName)}getAdUnitPath(){return this.gptWrapper.getAdUnitPath(this.slotName)}setTargeting(n,e){this.gptWrapper.setSlotTargeting(this.slotName,n,e)}getTargeting(n){try{return this.gptWrapper.getSlotTargeting(this.slotName,n)}catch{return[]}}getAllTargeting(){try{return this.gptWrapper.getAllSlotTargeting(this.slotName)}catch{return{}}}getRenderStatus(){return this.renderStatus}isEligibleToRender(){return!(this.isBlocked()||this.getRenderStatus()==="rendering"||this.hasEverBeenRequested()&&!this.isRefreshable())}isInViewport(){const n=this.getElement();return n?Xt(n):!1}isNearViewport(){const n=this.getElement();return tt(n,Q)}incrementRenderCount(){this.renderCount+=1,this.setTargeting("rv",this.renderCount.toString())}getRenderCount(){return this.renderCount}isRefreshable(){var n;return!!((n=this.currentSlotConfig.refresh)!=null&&n.enabled)&&this.emptyRetryCount<Qt}isBlocked(){return this.blocked}block(){this.blocked=!0}unblock(){this.blocked=!1}hasEverBeenRequested(){return this.renderStatus!=="not-rendered"}startRendering(){this.renderStatus="rendering",this.incrementRenderCount()}getSizes(){return this.currentSlotConfig.responsiveSizes}setSizes(n){this.currentSlotConfig.responsiveSizes=n;try{this.gptWrapper.updateSizeMapping(this.slotName,this.currentSlotConfig.responsiveSizes)}catch{}}removeSizes(n,e=pe.EXACT){const{sizes:t,responsiveSizes:r}=this.currentSlotConfig;if(!Array.isArray(t))return;const s=r.map(a=>{const[d,c]=a;return[d,z(c,n,e)]});this.setSizes(s),this.currentSlotConfig.sizes=z(t,n,e),this.currentSlotConfig.responsiveSizes=s,this.updateBidderConfigs(n,e)}getRefreshConfigRemoveSizes(){const{removeSizes:n}=this.currentSlotConfig.refresh??{};if(!(!this.isRefreshable()||!n))return n===!0?Jt:n}removeSizesFromSlotElement(){var s;const n=this.getRefreshConfigRemoveSizes();if(!n)return;const e=(s=this.getElement())==null?void 0:s.querySelector("iframe");if(!e)return;const t=e.getBoundingClientRect(),r=[n.match==="height"?0:t.width,n.match==="width"?0:t.height];this.removeSizes(r,n.with)}updateBidderConfigs(n,e){this.updateA9ConfigSize(n,e),this.updatePrebidConfigSize(n,e)}updateA9ConfigSize(n,e){const t=this.getBidderConfig("a9");t!=null&&t.sizes&&(t.sizes=z(t.sizes,n,e),this.setBidderConfig("a9",t))}updatePrebidConfigSize(n,e){var r,s;const t=this.getBidderConfig("prebid");(s=(r=t==null?void 0:t.mediaTypes)==null?void 0:r.banner)!=null&&s.sizes&&(t.mediaTypes.banner.sizes=z(t.mediaTypes.banner.sizes,n,e),this.setBidderConfig("prebid",t))}}class H extends HTMLElement{constructor(e){super();o(this,"adNodeManager");o(this,"adNode");this.adNodeManager=e}connectedCallback(){this.adNode||this.createAdNode()}disconnectedCallback(){this.adNodeManager.removeAdNode(this.adNode),this.adNode=void 0}createAdNode(){if(this.adNode=this.adNodeManager.createAdNode(this.id),!this.adNode)throw new Error(`AdNode for element with id[${this.id}] could not be created.`)}}o(H,"ELEMENT_NAME","fandom-ad");function rn(i){customElements.get(H.ELEMENT_NAME)||customElements.define(H.ELEMENT_NAME,class extends H{constructor(){super(i)}})}class sn{constructor(n,e){o(this,"adNodes",[]);o(this,"observer");this.slotConfigMap=n,this.gptWrapper=e,this.registerAdNodeComponent()}getSlotConfigMap(){return this.slotConfigMap}getSlotConfig(n){return this.slotConfigMap.baseSlots[n]??this.slotConfigMap.baseSlots[rt(n)]??this.slotConfigMap.videoSlots[n]}createAdNode(n,e){const t=e??this.getSlotConfig(n);if(!t){console.warn(`Cannot create adNode, no slot config found for slotName=[${n}]`);return}const r=new nn(n,t,this.gptWrapper);this.adNodes.push(r),this.gptWrapper.defineSlot(r);const s=r.getElement();return this.observer&&s&&this.startObservingElement(s),r}removeAdNode(n){const e=n.getElement();e&&this.stopObservingElement(e),n.destroy(),this.adNodes=this.adNodes.filter(t=>t.getSlotName()!==n.getSlotName())}getAdNodes(){return this.adNodes}getAdNodeByName(n){return this.adNodes.find(e=>e.getSlotName()===n)}getAdNodeByNameOrFail(n){const e=this.getAdNodeByName(n);return h(e,`adNode is not defined: ${n}`),e}blockSlot(n){this.getAdNodeByNameOrFail(n).block()}unblockSlot(n){this.getAdNodeByNameOrFail(n).unblock()}registerAdNodeComponent(){rn(this)}requestFirstCallSlotsAndObserveIntersection(n){this.startObservingSlots(e=>{const t=this.getAdNodes().filter(s=>s.getSlotConfig().isFirstCall&&!s.hasEverBeenRequested()),r=e.map(s=>{if(s.intersectionRatio>0){const a=this.getAdNodeByName(s.target.id);if(a&&!a.hasEverBeenRequested())return a}}).filter(s=>s!==void 0);n.requestRender([...new Set([...r,...t])])})}startObservingSlots(n){this.observer=new IntersectionObserver(n,{root:null,rootMargin:`${Q}px 0px ${Q}px 0px`,threshold:1}),this.getAdNodes().forEach(e=>{const t=e.getElement();t&&this.startObservingElement(t)})}startObservingElement(n){h(this.observer,"IntersectionObserver is not initialized"),this.observer.observe(n)}stopObservingElement(n){h(this.observer,"IntersectionObserver is not initialized"),this.observer.unobserve(n)}addAllStaticSlots(){const n=this.getSlotConfigMap().baseSlots;Object.values(n).forEach(e=>{e&&!e.dynamic&&!e.webComponent&&document.getElementById(e.name)&&this.createAdNode(e.name,e)})}}class on{constructor(n,e){o(this,"gptWrapper");o(this,"consentData");o(this,"pendingWaitForConsentResolver");o(this,"pendingWaitForBlockingResolver");this.hooks=e,this.consentData=window.fandomCmp,this.gptWrapper=n,this.startConsentUpdateListener()}startConsentUpdateListener(){const n=()=>{this.fandomCmpReady(window.fandomCmp)&&this.fandomConsentUpdateHandler()};window.addEventListener("fandomConsentUpdate",n),n()}async fandomConsentUpdateHandler(){var n,e;this.consentData=window.fandomCmp,this.updateGptPrivacySettings(),(n=this.pendingWaitForConsentResolver)==null||n.call(this,this.consentData),this.pendingWaitForConsentResolver=void 0,this.consentData.blocking||((e=this.pendingWaitForBlockingResolver)==null||e.call(this,this.consentData),this.pendingWaitForBlockingResolver=void 0),this.notifyPluginsOfConsentChange()}updateGptPrivacySettings(){this.consentData&&this.gptWrapper.updatePrivacySettings(this.consentData)}notifyPluginsOfConsentChange(){h(this.consentData,"Expected window.fandomCmp to have consent data before calling onConsentUpdated"),this.hooks.onConsentUpdated(this.consentData)}fandomCmpReady(n){return(n==null?void 0:n.ready)===!0}async waitForConsents(){return new Promise(n=>{this.consentData!==void 0&&this.fandomCmpReady(this.consentData)&&n(this.consentData),this.pendingWaitForConsentResolver=n})}async waitForBlockingOff(){return new Promise(n=>{var e,t;((e=this.consentData)==null?void 0:e.ready)===!0&&((t=this.consentData)==null?void 0:t.blocking)===!1&&n(this.consentData),this.pendingWaitForBlockingResolver=n})}}function ee(){var i,n;return((n=(i=window.ads)==null?void 0:i.context)==null?void 0:n.platform)??"app"}class an{constructor(n,e,t,r){o(this,"enableBidding",!0);o(this,"renderCycleCount",0);o(this,"isFirstRenderCycleComplete",!1);this.config=n,this.plugins=e,this.gptWrapper=t,this.adNodeManager=r}async waitForFirstRenderCycleComplete(){return this.isFirstRenderCycleComplete?!0:await Y(()=>this.isFirstRenderCycleComplete,{maxTries:50,fixedTimeout:50})}disableBidding(){this.enableBidding=!1}async start(){if(this.enableBidding){const n=[];T(this.plugins,"onBiddersInit",this,n);try{await Ie(n,this.config.icAdEngineBidderInitTimeoutMS,"onBiddersInit")}catch(e){console.warn("onBiddersInit timed out",e)}performance.mark(b.AE_ON_BIDDERS_INIT)}this.adNodeManager.requestFirstCallSlotsAndObserveIntersection(this)}async requestBids(n,e){if(!this.enableBidding)return;const t={auctionId:crypto.randomUUID(),adNodes:n,pageTargeting:this.gptWrapper.getAllTargeting(),renderCycleCount:e},r=(...s)=>{T(this.plugins,"onCreateBidderAdUnit",...s)};try{const s=[];T(this.plugins,"onCreateBiddersRequests",s,t,this,r),performance.mark(b.AE_AUCTION_START,{detail:{renderCycleCount:e,auctionId:t.auctionId}}),await Ie([...s],this.config.icAdEngineOnCreateBiddersRequestsTimeoutMS,`onCreateBiddersRequests [cycle ${e}]`),performance.mark(b.AE_AUCTION_END,{detail:{renderCycleCount:e,auctionId:t.auctionId}})}catch(s){console.warn("Bidders requests timed out",s)}}async requestRender(n=[]){const e=[];for(const r of n)r.isEligibleToRender()&&(r.startRendering(),e.push(r));if(!e.length)return;this.renderCycleCount++;const t=this.renderCycleCount;await this.requestBids(e,t),t===1&&(T(this.plugins,"onBeforeFirstCallAdsRequest",this.gptWrapper,this.adNodeManager),performance.mark(b.AE_BEFORE_FIRST_CALL_ADS_REQUEST)),t>1&&await this.waitForFirstRenderCycleComplete(),this.gptWrapper.requestSlots(e),t===1&&(await Y(()=>e[0].getRenderStatus()===st.RENDERED,{maxTries:50,fixedTimeout:50}),this.isFirstRenderCycleComplete=!0)}}async function dn(i){if(window.fandomAdsSlotsConfig)return window.fandomAdsSlotsConfig;{const{loadConfig:n}=await S(async()=>{const{loadConfig:t}=await import("./handleDynamicConfig-rAEdX3gE.js");return{loadConfig:t}},[]),e=await n(i);return window.fandomAdsSlotsConfig=e,e}}async function cn(){return new Promise(i=>{window.fandomHost=window.fandomHost??{},window.fandomHost.cmd=window.fandomHost.cmd??[],window.fandomHost.cmd.push(i)})}async function ln(i,n){const e=await dn(ee()),t={};T(n,"onInitPageTargeting",t),T(n,"onInitSlotConfigMap",e);const r=new Yt(t,{onBeforeAdsRequest:(c,l)=>{T(n,"onBeforeAdsRequest",c,l)}}),s=new on(r,{onConsentUpdated:c=>{T(n,"onConsentUpdated",c)}});await Promise.all([s.waitForConsents(),cn()]),await r.enableServices(),T(n,"onAfterGptWrapperInit",r),performance.mark(b.AE_AFTER_GPT_WRAPPER_INIT);const a=new sn(e,r);a.addAllStaticSlots(),T(n,"onAfterAdNodeManagerInit",a,e.baseSlots),await s.waitForBlockingOff();const d=new an(i,n,r,a);return T(n,"onAdEngineInit",d),performance.mark(b.AE_AD_ENGINE_INIT),d}var O;class u{constructor(){ne(this,O);o(this,"api");o(this,"hooks",{})}static isEnabled(n){return!!n}setPlugins(n){Array.isArray(n)?G(this,O,new Map(n.map(e=>[e.constructor,e]))):G(this,O,n)}usePlugin(n){var e,t;return(t=(e=V(this,O))==null?void 0:e.get(n))==null?void 0:t.api}}O=new WeakMap;function ot(){var i;return((i=window.ads)==null?void 0:i.context)??null}class un{constructor(n,e){o(this,"AMZN_TOKEN_NAME","AMZN-Token");o(this,"APSTAG_RECORD_KEY","apstagRecord");o(this,"APSTAG_HEM_SENT_KEY","apstagHEMsent");o(this,"APSTAG_HEM_OPTOUT_KEY","apstagHEMoptOut");o(this,"AMAZON_TOKEN_TTL",14*24*60*60*1e3);o(this,"storage",new Qe);this.config=n,this.consentData=e}updateConsentData(n,e){this.consentData=n,this.updateApstagPublisherAudienceConfig(e)}updateApstagPublisherAudienceConfig({gdprParam:n}){var s,a;if(this.cleanUpA9TokensIfApplicable(),!this.isHemSyncingEnabled())return;const e=this.resolveHashedEmailSource(),{optOut:t}=this.consentData;if(!e){console.warn("Can't update HEM without an email record."),t&&window.apstag&&((a=(s=window.apstag).dpa)==null||a.call(s));return}const r={...n,optOut:t,hashedRecords:[{type:"email",record:e}]};this.syncHemIfApplicable(r)}getApstagRecordFromStorage(){return this.storage.getItem(this.APSTAG_RECORD_KEY)}getHashedEmailFromAdsContext(){var e;const n=(e=ot())==null?void 0:e.opts.userEmailHashes;return!Array.isArray(n)||(n==null?void 0:n.length)!==3?null:n[2]}resolveHashedEmailSource(){return this.getApstagRecordFromStorage()??this.getHashedEmailFromAdsContext()??null}syncHemIfApplicable(n){var s,a,d,c;const e=(a=(s=n==null?void 0:n.hashedRecords)==null?void 0:s[0])==null?void 0:a.record,{optOut:t}=n;if(!e)return;const r=this.deriveApstagTokenizationFunction(t);r&&window.apstag&&((c=(d=window.apstag)[r])==null||c.call(d,n,()=>{this.updateApstagConsentInLocalStorage(e,t)}))}deriveApstagTokenizationFunction(n){return this.checkIfUserConsentChanged(n)?"upa":this.checkIfA9TokenShouldBeRenewed()?"rpa":null}checkIfA9TokenShouldBeRenewed(){const n=this.storage.getItem(this.APSTAG_HEM_SENT_KEY,!0);if(!n)return!0;const e=parseInt(n,10);return isNaN(e)?!0:e<Date.now()}checkIfUserConsentChanged(n){const e=this.storage.getItem(this.APSTAG_HEM_OPTOUT_KEY,!1);return e!==null&&n!==e}isHemSyncingEnabled(){return this.config.icA9HEM&&!this.config.icA9CleanHEM}updateApstagConsentInLocalStorage(n,e){this.storage.setItem(this.APSTAG_RECORD_KEY,n),this.storage.setItem(this.APSTAG_HEM_OPTOUT_KEY,e.toString()),y.get(this.AMZN_TOKEN_NAME)?this.storage.setItem(this.APSTAG_HEM_SENT_KEY,(Date.now()+this.AMAZON_TOKEN_TTL).toString()):this.storage.removeItem(this.APSTAG_HEM_SENT_KEY)}cleanUpA9TokensIfApplicable(){this.config.icA9CleanHEM&&this.cleanUpA9Tokens()}cleanUpA9Tokens(){var n,e;(y.get(this.AMZN_TOKEN_NAME)||this.storage.getItem(this.APSTAG_RECORD_KEY))&&((e=(n=window.apstag)==null?void 0:n.dpa)==null||e.call(n),this.storage.removeItem(this.APSTAG_RECORD_KEY),this.storage.removeItem(this.APSTAG_HEM_SENT_KEY),this.storage.removeItem(this.APSTAG_HEM_OPTOUT_KEY),y.delete(this.AMZN_TOKEN_NAME,{path:"/"}))}}class gn{constructor(n,e,t,r){o(this,"apstagConfigParams");o(this,"a9HemSyncer");this.consentData=n,this.timeout=e,this.config=t,this.apstagConfigParams={pubID:"3115",adServer:"googletag",videoAdServer:"DFP",simplerGPT:!0,deals:!0,bidTimeout:this.timeout,signals:r?{ortb2:r}:{}},this.a9HemSyncer=new un(this.config,this.consentData),this.init(!0)}configureCommand(n,e){window.apstag._Q.push([n,e])}updateApstagOrtb2Signals(n){n&&(this.apstagConfigParams.signals.ortb2=n,this.updateApstagConfig())}updateApstagConfig(){if(window.apstag){const{gdprParam:n,uspParam:e}=this.getConsentsParams();window.apstag.init({...this.apstagConfigParams,...n,...e})}}init(n){window.apstag=window.apstag??{_Q:[],init:(...t)=>{this.configureCommand("i",t)},fetchBids:(...t)=>{this.configureCommand("f",t)}};const e=this.getConsentsParams();this.updateApstagConfig(),n&&this.a9HemSyncer.updateApstagPublisherAudienceConfig(e)}getConsentsParams(){return{gdprParam:this.consentData.consentApi==="tcf"?{gdpr:{cmpTimeout:this.timeout}}:{gdpr:{enabled:!1}},uspParam:this.getUspParam()}}handleConsentChange(n){this.consentData=n;const e=this.getConsentsParams();this.updateApstagConfig(),this.a9HemSyncer.updateConsentData(n,e)}getUspParam(){return this.consentData.consentApi==="usp"&&this.consentData.consentString?{params:{us_privacy:this.consentData.consentString}}:{}}async requestBids(n,e){if(this.consentData.blocking||this.consentData.coppa)return[];h(window.apstag,"window.apstag has not been initialized yet");const t={slots:this.buildBidsConfig(n.adNodes),timeout:this.timeout};return t.slots.length?(e("a9",n,t),new Promise(r=>{var s;(s=window.apstag)==null||s.fetchBids(t,a=>{var d,c;(c=(d=window.apstag)==null?void 0:d.setDisplayBids)==null||c.call(d),r(a)})})):[]}buildBidsConfig(n){const e=[];return n.forEach(t=>{const r=t.getBidderConfig("a9");if(!r)return;const s=t.getSlotName(),a={slotName:t.getAdUnitPath()??s,slotID:s,...r};e.push(a)}),e}}const at=6,hn="1217",pn="bsr004",fn="1014",mn=40,En=50,ye={main_vertical:{from:"main_vertical",limit:"one-of-each"},main_entity_type:{from:"main_entity_type",limit:"one-of-each"},genre:{from:"genres",addConfidence:"site"},subgenre:{from:"subgenres",addConfidence:"site"},vertical:{from:"verticals",addConfidence:"all"},themes:{from:"themes",addConfidence:"site"},fran:{from:"franchises"}};function dt(i){const n=(window==null?void 0:window.fandomTaxonomy)??{};return(n==null?void 0:n[i])??[]}function C(i){const n=[hn,pn],e=dt(i),t=(e==null?void 0:e.iab_categories)??[];return t.length>0?n.push(...t):n.push(fn),Array.from(new Set(n.filter(Boolean)))}function bn(i){return typeof i!="number"||isNaN(i)?"":`_c${0+Math.floor(i*10)}`}function Sn(i){return typeof i!="object"||i===null?i:Object.keys(i).reduce((n,e)=>(i[e]&&i[e].length>0&&(n[e]=i[e]),n),{})}function An(i){return typeof i=="object"&&i&&typeof i.value=="string"&&i.value.length>0&&typeof i.confidence=="number"}function Ce(i,n){const e={site:"s_",page:"p_"},t=dt(i);let r=(t==null?void 0:t[n])??[];return Array.isArray(r)||(r=[r]),r.filter(An).map(s=>({...s,value:`${e[i]}${s.value}`}))}function Tn(i){const{from:n,addConfidence:e=!1,limit:t}=i,r=Pe(Ce("site",n),e==="site"||e==="all"),s=Pe(Ce("page",n),e==="page"||e==="all"),a=t==="one-of-each"?1:void 0;return In([...r.slice(0,a),...s.slice(0,a)]).filter(Boolean).map(wn).slice(0,En)}function In(i){return i.sort((n,e)=>e.confidence-n.confidence)}function Pe(i,n){return n?i.map(_n):i}function _n(i){return{...i,value:`${i.value}${bn(i.confidence)}`}}function wn(i){return i.value.substring(0,mn)}function Re(){const i=Object.keys(ye).reduce((n,e)=>(n[e]=Tn(ye[e]),n),{});return Sn(i)}const vn=500;class ct extends u{constructor(){super(...arguments);o(this,"targetingApplied",!1);o(this,"hooks",{onBeforeAdsRequest:e=>{this.waitForFandomTaxonomyPresent().then(()=>this.updateGpt(e))}});o(this,"api",{getIABPageCategories:()=>C("page"),getIABSiteCategories:()=>C("site"),getTargetingKeyValues:()=>Re()})}async waitForEvent(){return new Promise(e=>{const t=()=>e();window.addEventListener("FandomTaxonomyUpdated",()=>{window.removeEventListener("FandomTaxonomyUpdated",t),e()})})}async waitForFandomTaxonomyPresent(){if(!window.fandomTaxonomy)try{await U(Promise.any([Y(()=>!!window.fandomTaxonomy),this.waitForEvent()]),vn)}catch{console.warn("waitForFandomTaxonomyPresent timed out")}}updateGptConfig(e){e.setConfig({pps:{taxonomies:{IAB_CONTENT_2_2:{values:[...new Set([...C("site"),...C("page")])]}}}})}getIABKeyValues(){return{cattax:[at.toString()],cat:C("site"),pagecat:C("page")}}updateGptKVs(e){Object.entries({...this.getIABKeyValues(),...Re()}).forEach(([t,r])=>{const s=e.getTargeting(t);s&&s.length>0&&(r=[...new Set([...s,...r])]),e.setTargeting(t,r)})}updateGpt(e){this.targetingApplied||(this.targetingApplied=!0,this.updateGptKVs(e),this.updateGptConfig(e))}}class yn{constructor(n){o(this,"prebidReady",!1);o(this,"pbjs");this.prebidConfig=n,window.pbjs=window.pbjs??{},window.pbjs.que=window.pbjs.que??[],this.pbjs=window.pbjs,this.pbjs.que.push(()=>{this.pbjs.bidderSettings={standard:{storageAllowed:!0}},this.pbjs.setConfig({...this.prebidConfig}),this.prebidReady=!0})}isPrebidReady(){return this.prebidReady}defineAdUnits(n){this.pbjs.que.push(()=>{this.pbjs.addAdUnits(n)})}requestBids(n){this.pbjs.que.push(()=>{this.pbjs.requestBids(n)})}setTargetingForGPTAsync(n,e){this.pbjs.que.push(()=>{var t,r;(r=(t=this.pbjs).setTargetingForGPTAsync)==null||r.call(t,n,e)})}pushToQueue(n){this.pbjs.que.push(()=>n(this.pbjs))}}const Cn={cache:{url:"https://prebid.adnxs.com/pbc/v1/cache"},debug:!1,enableTIDs:!0,enableSendAllBids:!0,sendBidsControl:{bidLimit:2,dealPrioritization:!0},priceGranularity:"dense",targetingControls:{alwaysIncludeDeals:!0,allowTargetingKeys:["AD_ID","BIDDER","PRICE_BUCKET","UUID","SIZE","DEAL","CACHE_HOST"],allowSendAllBidsTargetingKeys:["AD_ID","BIDDER","PRICE_BUCKET","UUID","SIZE","DEAL"]},timeoutBuffer:400,useBidCache:!1,userSync:{filterSettings:{iframe:{bidders:"*",filter:"include"},image:{bidders:"*",filter:"include"}},userIds:[],auctionDelay:50,syncsPerBidder:3,syncDelay:6e3}};class E{constructor(...n){o(this,"configFlags");this.configFlags=n}isEnabled(n){return this.configFlags.length===0?!0:this.configFlags.every(e=>!!n[e])}transformAdUnitBidConfigs(n){return n}}class Pn extends E{transformAdUnitBidConfigs(n,e){for(const t of n)t.params.keywords={...e.pageTargeting};return n}}class Rn extends E{transformAdUnitBidConfigs(n,e){for(const t of n)t.params.customData=[{settings:{},targeting:{...e.pageTargeting}}];return n}}class Nn extends E{transformAdUnitBidConfigs(n,e){for(const t of n)t.params.keywords=["rp.fastlane"],t.params.inventory={...t.params.inventory,...this.formatPageTargetingForRubicon(e.pageTargeting)};return n}formatPageTargetingForRubicon(n){return Object.fromEntries(Object.entries(n).map(([e,t])=>[e,t?[String(t)]:[]]))}}const Ln={appnexus:new Pn("icPrebidAppNexus"),gumgum:new E("icPrebidGumGum"),ix:new E("icPrebidIX"),kargo:new E("icPrebidKargo"),mgnipbs:new E("icPrebidMagniteS2s"),medianet:new E("icPrebidMedianet"),nobid:new E("icPrebidNobid"),openx:new E("icPrebidOpenX"),ozone:new Rn("icPrebidOzone"),pubmatic:new E("icPrebidPubmatic"),rubicon:new Nn("icPrebidRubicon"),seedtag:new E("icPrebidSeedtag"),triplelift:new E("icPrebidTriplelift"),wikia:new E};function On(){return x("pbjs_debug")}const kn=i=>{if(i.icPrebidSharedId)return{name:"pubCommonId",storage:{type:"cookie",name:"_pubcid",expires:365}}},Bn=i=>{if(!i.icPrebidId5)return;const n={name:"id5Id",params:{partner:1139},storage:{type:"html5",name:"id5id",expires:90,refreshInSeconds:8*3600}};return i.icPrebidId5ExternalModule&&Object.assign(n.params,{externalModuleUrl:"https://cdn.id5-sync.com/api/1.0/id5PrebidModule.js"}),n},Dn=i=>i.icLiveIntentConnectedId?{name:"liveIntentId",params:{publisherId:"79968",requestedAttributesOverrides:{uid2:!0,bidswitch:!0,medianet:!0,magnite:!0,pubmatic:!0,index:!0,openx:!0,thetradedesk:!0,sovrn:!0},ajaxTimeout:1e3,liCollectConfig:{fpiStorageStrategy:"ls",fpiExpirationDays:730}},storage:{name:"__tamLIResolveResult",type:"html5",expires:1}}:void 0,Fn={ignoreOptOut:!1,ignoreBlocking:!1,ignoreCoppa:!1},A=(i,n={})=>{const{ignoreBlocking:e,ignoreCoppa:t,ignoreOptOut:r}={...Fn,...n},s=(a,d)=>d?!0:!a;return!!(i&&i.ready&&s(i.optOut,r)&&s(i.blocking,e)&&s(i.coppa,t))},Mn="https://b-code.liadm.com/a-07ev.min.js",xn="0.3",Un={unifiedId:"liveConnect-unifiedId",sha2:"liveConnect",md5:"liveConnect-md5",sha1:"liveConnect-sha1"},Ne="LiveConnectPluginReady",ie=i=>Un[i];class W extends u{constructor(e){super();o(this,"storage",null);o(this,"libraryLoaded",!1);o(this,"consent",!1);o(this,"hooks",{onConsentUpdated:e=>{A(e)&&(this.consent=!0,this.setupStorage())}});o(this,"api",{waitForHem:()=>new Promise(e=>{this.consent||e(null),this.libraryLoaded?e(this.getFromStorage("sha2")):window.addEventListener("LiveConnectPluginReady",()=>{e(this.getFromStorage("sha2"))})}),checkIfHemAvailable:()=>W.isEnabled(this.config)?this.isAvailableInStorage("sha2"):!1});this.config=e}static isEnabled(e){return(e==null?void 0:e.icLiveConnect)&&(e==null?void 0:e.icLiveConnectCachingStrategy)&&!(e!=null&&e.icIdentityPartners)}setupStorage(){!this.consent||this.storage||(this.storage=new Qe(this.config.icLiveConnectCachingStrategy.type==="local"?()=>window.localStorage:()=>window.sessionStorage),this.shouldLoadScript()?I({src:Mn,isAsyncOrDeferOtherwise:!0,node:"first"}).then(()=>this.resolveAndTrackIds()):(this.libraryLoaded=!0,window.dispatchEvent(new Event(Ne))))}getHEMTypes(){return this.config.icLiveConnectCachingStrategy.mandatoryParams}shouldLoadScript(){return this.getHEMTypes().some(t=>!this.isAvailableInStorage(t))}resolveAndTrackIds(){var e,t,r;(r=window.liQ)==null||r.resolve(s=>{for(const[a,d]of Object.entries(s))d&&this.storeId(a,d);this.libraryLoaded=!0,window.dispatchEvent(new Event(Ne))},s=>{console.error(s)},{qf:((t=(e=this.config)==null?void 0:e.icLiveConnectQf)==null?void 0:t.toString())??xn,resolve:["sha2","md5","sha1","unifiedId"]})}storeId(e,t){var r;this.isAvailableInStorage(e)||(r=this.storage)==null||r.setItem(ie(e),t,this.config.icLiveConnectCachingStrategy.ttl)}isAvailableInStorage(e){var t;return!!((t=this.storage)!=null&&t.getItem(ie(e)))}getFromStorage(e){var t;return((t=this.storage)==null?void 0:t.getItem(ie(e)))??null}}function Wn(i){const n=i.match(/.{2}/g);if(!n)throw new Error("Invalid input string");return btoa(String.fromCharCode(...n.map(e=>parseInt(e,16))))}const Vn="VCaqxS6v2X",Gn="UID2-X-P-MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEOE+DsIa2aJWHIYpG+JrLpe0uxwrGe9aC4NaP7lQMN9+9/pk/7vydOrzQvxeDSlThIiMwGRMpyjAa593RYoGtFA==",zn=async(i,n)=>{if(i.icPrebidUID2)try{const e=n.usePlugin(W);if(!e)return;const t=await e.waitForHem();if(t)return{name:"uid2",params:{serverPublicKey:Gn,subscriptionId:Vn,emailHash:Wn(t)}}}catch{return}},jn=i=>{var n,e;if(i.icPrebidYahooConnectId)return{name:"connectId",params:{pixelId:"58833",puid:((e=(n=window.fandomContext)==null?void 0:n.tracking)==null?void 0:e.ppid)??"0"},storage:{type:"html5",name:"connectId",expires:15}}},Hn=[kn,Bn,Dn,jn],qn=(i,n)=>{var t;const e=Hn.map(r=>r(n)).filter(r=>r!==void 0);return i.userSync??(i.userSync={}),(t=i.userSync).userIds??(t.userIds=[]),i.userSync.userIds.push(...e),i},$n=[zn],Kn=(i,n,e)=>{$n.forEach(t=>{t(i,n).then(r=>{if(!r)return;const s=e.getConfig("userSync");s.userIds??(s.userIds=[]),s.userIds.push(r),e.mergeConfig({userSync:s})})})};class _ extends u{constructor(e){super();o(this,"prebidWrapper");o(this,"activeBidders",new Map);o(this,"hooks",{onBiddersInit:(e,t)=>{t.push(this.waitForPrebidReady())},onCreateBiddersRequests:(e,t,r,s)=>{e.push(this.requestBids(t,s))}});o(this,"api",{addPrebidReadyCallback:e=>{this.prebidWrapper.pushToQueue(e)}});this.config=e,this.prebidWrapper=this.initPrebidWrapper(),this.initBidderAdapters()}async waitForPrebidReady(){const e=new Promise(t=>{this.api.addPrebidReadyCallback(()=>t())});await U(e,this.config.icPrebidInitTimeoutMS,"PrebidPlugin.waitForPrebidReady")}initPrebidWrapper(){const e=qn({...Cn,bidderTimeout:this.config.icAdEngineAuctionTimeoutMS,debug:On()},this.config),t=new yn(e);return t.pushToQueue(r=>Kn(this.config,this,r)),t}initBidderAdapters(){for(const[e,t]of Object.entries(Ln))t.isEnabled(this.config)&&this.activeBidders.set(e,t)}generateAdUnitBids(e,t){var s;const r=[];for(const[a,d]of Object.entries(e.bids))if(this.activeBidders.has(a)){const c=((s=this.activeBidders.get(a))==null?void 0:s.transformAdUnitBidConfigs(d,t,this.config))??[];r.push(...c)}return r}generateAdUnits(e){const t=[];for(const r of e.adNodes){const s=r.getBidderConfig("prebid");if(!s)continue;let a=[];s.bids&&(a=this.generateAdUnitBids(s,e));const d={...s,code:r.getSlotName(),bids:a};t.push(d)}return t}async requestBids(e,t){return h(this.prebidWrapper.isPrebidReady(),"PrebidPlugin.requestBids: Prebid.js is not ready"),new Promise(r=>{const s=this.generateAdUnits(e);t("prebid",e,s),this.prebidWrapper.requestBids({auctionId:e.auctionId,adUnits:s,bidsBackHandler:()=>{this.prebidWrapper.setTargetingForGPTAsync(),r()}})})}}class lt extends u{constructor(){super(...arguments);o(this,"pageTargeting",{});o(this,"adEngine");o(this,"dsaSettings",{dsa:{dsarequired:1,pubrender:2,datatopub:2}});o(this,"orbt2SiteCategories",[]);o(this,"ortb2PageCategories",[]);o(this,"hooks",{onAdEngineInit:e=>{this.adEngine=e;const t=this.usePlugin(_);t==null||t.addPrebidReadyCallback(r=>{this.pageTargeting={...e.gptWrapper.getAllTargeting()},this.extendPrebidConfig(r)})}});o(this,"api",{getOrtb2:(e={})=>{var r;const t=((r=this.adEngine)==null?void 0:r.gptWrapper.getAllTargeting())??{};return this.pageTargeting={...t,...e},this.getOrtb2()}})}getKeywordsSet(e){return new Set([...e.gnre??[],...e.media??[],...e.theme??[],...e.tv??[]])}buildKeywords(){var t;const e=(t=window==null?void 0:window.fandomContext)==null?void 0:t.site;return e!=null&&e.tags?Array.from(this.getKeywordsSet(e.tags).values()).filter(Boolean).join(","):""}setOrtb2Categories(){const e=this.usePlugin(ct);this.orbt2SiteCategories=(e==null?void 0:e.getIABSiteCategories())??[],this.ortb2PageCategories=(e==null?void 0:e.getIABPageCategories())??[]}getOrtb2(){var e;return this.setOrtb2Categories(),{site:{cattax:at,cat:[...this.orbt2SiteCategories],pagecat:[...this.ortb2PageCategories],id:(e=this.pageTargeting.pageId)==null?void 0:e.toString(),name:this.pageTargeting.pageName,content:{language:this.pageTargeting.lang,context:5},keywords:this.buildKeywords(),domain:window.location.hostname},regs:{ext:{...this.dsaSettings}}}}extendPrebidConfig(e){e.mergeConfig({ortb2:this.getOrtb2()})}}const J=class J extends u{constructor(e){super();o(this,"wrapper",null);o(this,"hooks",{onConsentUpdated:e=>{A(e,{ignoreOptOut:!0})&&(this.wrapper?this.wrapper.handleConsentChange(e):this.initWrapper(e))},onCreateBiddersRequests:(e,t,r,s)=>{e.push(this.executeBidRequest(t,s))}});this.config=e}static isEnabled(e){return!!e.icA9Bidder}trackBidResponse(e,t,r){t.forEach(s=>{const a=s.slotID;let d=0,c=a;const l=e.adNodes.find(p=>p.getSlotName()===a);if(l&&(d=l.getRenderCount(),c=l.getBaseSlotName()),d>1||s.size=="0x0")return;const m={bidderName:J.A9_BIDDER_NAME,size:s.size,price:s.targeting.amznbid,timeToRespond:Math.round(r),timedOut:!1},g={slotName:a,baseSlotName:c,rv:d,bidInfo:m};f(w.BIDDER_RESPONSE,g)})}async executeBidRequest(e,t){h(this.wrapper,"A9Wrapper has not been initialized");const r=`${b.AE_AUCTION_START_A9_START}_${e.auctionId}`;performance.mark(r),this.wrapper.updateApstagOrtb2Signals(this.getOrtb2Object());const s=await this.wrapper.requestBids(e,t),{duration:a}=performance.measure(Xe.AE_AUCTION_DURATION_A9_BID_TOTAL_TIME,r);this.trackBidResponse(e,s,a)}initWrapper(e){this.wrapper??(this.wrapper=new gn(e,this.config.icAdEngineAuctionTimeoutMS,this.config,this.getOrtb2Object()))}getOrtb2Object(e){var t;return(t=this.usePlugin(lt))==null?void 0:t.getOrtb2(e)}};o(J,"A9_BIDDER_NAME","a9");let de=J;const ut="grbqPYtkDC5HPMrgd",Yn=`//${ut}.ay.delivery/client-v2.js`;class Qn extends u{constructor(e){super();o(this,"floor");o(this,"isLoaded",!1);o(this,"hooks",{onConsentUpdated:e=>{A(e)&&this.init()}});this.config=e,this.floor=e.icAssertiveYieldFloors}static isEnabled(e){return e==null?void 0:e.icAssertiveYield}createAssertiveYieldWindowObject(){window.assertive??(window.assertive={debug:!1,entityId:ut,analytics:{integrations:{webAnalytics:!0},logUnfilled:!0,custom:{layout:null,userState:null,custom_1:null,custom_2:null,custom_3:null,custom_4:null}},hash:{generator:"server",values:1,key:"ay"}})}async createAndInsertScript(){try{await I(Yn),this.isLoaded=!0}catch(e){console.error("Failed to load AssertiveYield script",e)}}init(){this.isLoaded||(this.createAssertiveYieldWindowObject(),this.createAndInsertScript())}}class Xn extends u{constructor(e){super();o(this,"isTcfAvailable",!1);o(this,"isUspAvailable",!1);o(this,"hooks",{onConsentUpdated:({coppa:e,consentApi:t})=>{var r;this.isTcfAvailable=t==="tcf",this.isUspAvailable=t==="usp",(r=this.usePlugin(_))==null||r.addPrebidReadyCallback(s=>{s.mergeConfig({coppa:e})})},onBiddersInit:()=>{var e;(e=this.usePlugin(_))==null||e.addPrebidReadyCallback(t=>{this.isTcfAvailable&&t.mergeConfig({consentManagement:{gdpr:{cmpApi:"iab",timeout:this.config.icPrebidConsentManagementTimeoutMS,allowAuctionWithoutConsent:!1,defaultGdprScope:!1}}}),this.isUspAvailable&&t.mergeConfig({consentManagement:{usp:{cmpApi:"iab",timeout:this.config.icPrebidConsentManagementTimeoutMS}}})})}});this.config=e}}class gt{constructor(n){o(this,"iconSvg",'<svg width="9" height="9" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 22C6.48605 22 2.00005 17.514 2.00005 12C2.00005 6.486 6.48605 2 12 2C17.514 2 22 6.486 22 12C22 17.514 17.514 22 12 22M12 0C5.383 0 0 5.383 0 12C0 18.617 5.383 24 12 24C18.617 24 24 18.617 24 12C24 5.383 18.617 0 12 0" clip-rule="evenodd"/><path d="M10.9998 18.0171V10.0096C10.9998 9.4556 11.4467 9.00777 11.9997 9.00777 12.5527 9.00777 12.9997 9.4556 12.9997 10.0096V18.0171C12.9997 18.5711 12.5527 19.0189 11.9997 19.0189 11.4467 19.0189 10.9998 18.5711 10.9998 18.0171zM12.0057 7.01379C11.4527 7.01379 10.9998 6.55995 10.9998 6.00693 10.9998 5.4539 11.4527 5.00006 12.0057 5.00006 12.5587 5.00006 13.0107 5.4539 13.0107 6.00693 13.0107 6.55995 12.5587 7.01379 12.0057 7.01379" clip-rule="evenodd"/></svg>');this.props=n}render(){const e=new DOMParser().parseFromString(this.iconSvg,"image/svg+xml").documentElement,t=()=>{document.querySelectorAll(".dsa-dialog").forEach(a=>{document.body.removeChild(a)})},r=async()=>{const{AdvertisementInfoDialog:s}=await S(async()=>{const{AdvertisementInfoDialog:d}=await import("./AdvertisementInfoDialog-ftkjtV7l.js");return{AdvertisementInfoDialog:d}},[]);t();const a=new s(this.props).render();document.body.appendChild(a),a.showModal()};return jsxRenderer("span",{className:"dsa-advertisement-label-icon",onClick:r},e)}}class Le{constructor(n){o(this,"translatedAdLabel",document.querySelector(".ae-translatable-label"));this.props=n}render(){const{behalf:n,paid:e}=this.props,t=new gt({behalf:n,paid:e}).render();return jsxRenderer("div",{className:"ae-translatable-label advertisement-label",id:"label-"+this.props.slot},jsxRenderer("span",{className:"dsa-advertisement-label-clickable"},this.translatedAdLabel?this.translatedAdLabel.innerText:"Advertisement ",t))}}class Jn extends u{constructor(){super(...arguments);o(this,"adUnitsWithoutDynamicLabel",["interstitial","floor_adhesion"]);o(this,"defaultDSAPrebidSettings",{dsarequired:1,pubrender:2,datatopub:2});o(this,"hooks",{onBiddersInit:()=>{const e=this.usePlugin(_);h(e,"PrebidPlugin not found"),e.addPrebidReadyCallback(t=>{this.extendPrebidConfig(t),this.attachPrebidEventsHandlers(t)})}})}extendPrebidConfig(e){e.mergeConfig({ortb2:{regs:{ext:{dsa:{...this.defaultDSAPrebidSettings}}}}})}getBidMeta(e){return e.meta??{}}getDSAMeta(e){return this.getBidMeta(e).dsa??null}isDSADataAvailable(e){var t,r;return typeof((t=this.getDSAMeta(e))==null?void 0:t.behalf)=="string"&&typeof((r=this.getDSAMeta(e))==null?void 0:r.adrender)=="number"}handleRegularAdUnit(e){var a;const{behalf:t,paid:r}=this.getDSAMeta(e),s=new Le({slot:e.adUnitCode,behalf:t,paid:r}).render();(a=document.getElementById(e.adUnitCode))==null||a.appendChild(s)}handleTopLeaderboard(e){var d;const t=document.querySelector(".top-ads-container .ae-translatable-label"),{behalf:r,paid:s}=this.getDSAMeta(e),a=new gt({behalf:r,paid:s}).render();t.classList.add("advertisement-label","dsa-advertisement-label-clickable"),(d=t.querySelector(".dsa-advertisement-label-icon"))==null||d.remove(),t.appendChild(a)}handleIncontentSlots(e,t){const r=this.getRealSlotName(t);if(!r)return;const s=document.getElementById(r);if(!s)return;const{behalf:a,paid:d}=this.getDSAMeta(e),c=new Le({slot:e.adUnitCode,behalf:a,paid:d}).render();s.appendChild(c)}attachPrebidEventsHandlers(e){const t=({bid:r,doc:s})=>{if(!(!this.isDSADataAvailable(r)||this.adUnitsWithoutDynamicLabel.includes(r.adUnitCode)))switch(r.adUnitCode){case"top_leaderboard":this.handleTopLeaderboard(r);break;case"incontent_leaderboard":case"incontent_boxad":this.handleIncontentSlots(r,s);break;default:this.handleRegularAdUnit(r)}};e.onEvent("adRenderSucceeded",t)}getRealSlotName(e){var t,r,s,a;return(a=(s=(r=(t=e==null?void 0:e.defaultView)==null?void 0:t.frameElement)==null?void 0:r.parentElement)==null?void 0:s.parentElement)==null?void 0:a.id}}const Zn=(i,...n)=>i.reduce((t,r,s)=>{const a=n[s]||"";return t+r+a},"").replace(/\s+/g," ").trim(),ht=document.createElement("style");document.head.appendChild(ht);const Oe=ht.sheet,ei=i=>typeof(i==null?void 0:i.dynamic)=="object"&&!!i.dynamic.single;class ti extends u{constructor(){super(...arguments);o(this,"hooks",{onAfterAdNodeManagerInit:(e,t)=>{Object.values(t).forEach(r=>{try{ei(r)&&this.handleDynamicSingleSlot(r,e)}catch(s){console.error(`Dynamic slot "${r.name}" failed to render:`,s)}})}})}renderWrapper(e,t){const r=document.createElement("div");return r.id=e,t&&Oe&&Oe.insertRule(Zn`
        #${e} {
          ${t}
        }
      `),r}handleDynamicSingleSlot(e,t){const r=e.dynamic.single,s=document.querySelector(r.selector);if(!s){console.warn(`Dynamic slot anchor element with selector "${r.selector}" not found`);return}this.renderDynamicSlot(s,e.name,r),t.createAdNode(e.name,e)}renderDynamicSlot(e,t,r){var a;const s=document.createElement("div");if(s.id=t,(a=r.wrapper)!=null&&a.id){const d=this.renderWrapper(r.wrapper.id,r.wrapper.css);d.appendChild(s),e[r.insertMethod](d);return}e[r.insertMethod](s)}}class ni extends u{constructor(){super(...arguments);o(this,"api",{exampleExposedMethod:()=>{console.log("Example exposed method called")}})}}const ii=".mw-parser-output > h2";function k(i){var e;return!!((ri(i)??{}).hasFeaturedVideo&&((e=window.canPlayVideo)!=null&&e.call(window)))}function pt(i){return!k(i)&&!!document.querySelector(ii)}function ke(){var i,n,e;return((n=(i=window.mw)==null?void 0:i.config)==null?void 0:n.get("wgArticleFeaturedVideo"))??((e=window.RLCONF)==null?void 0:e.wgArticleFeaturedVideo)??null}function ri(i){var n;return i??((n=window.ads)==null?void 0:n.context.targeting)}const si='<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.707 4.293a.999.999 0 0 0-1.414 0L12 10.586 5.707 4.293a.999.999 0 1 0-1.414 1.414L10.586 12l-6.293 6.293a.999.999 0 1 0 1.414 1.414L12 13.414l6.293 6.293a.997.997 0 0 0 1.414 0 .999.999 0 0 0 0-1.414L13.414 12l6.293-6.293a.999.999 0 0 0 0-1.414" fill-rule="evenodd"/></svg>';function oi(i){const n=new DOMParser,e=document.createElement("button"),t=["button-control","button-close","floor-adhesion-close-button"],r=n.parseFromString(si,"image/svg+xml").documentElement;return e.appendChild(r),e.classList.add(...t),e.addEventListener("click",i),e}class ce{constructor(n=0){o(this,"observers",new Map);o(this,"history",[]);this.historySize=n}subscribe(n){const e=Symbol();return this.observers.set(e,n),this.historySize>0&&this.history.forEach(t=>n(t)),()=>{this.observers.delete(e)}}notify(n){this.historySize>0&&(this.history.push(n),this.history.length>this.historySize&&this.history.shift()),this.observers.forEach(e=>e(n))}}function X(){var i;return((i=window.fandomHost)==null?void 0:i.device)==="smartphone"}const N={DESKTOP_COLLAPSE:[9,9],DESKTOP_SUCCESS:[11,11],MOBILE_COLLAPSE:[6,6],MOBILE_SUCCESS:[8,8]};function Be(i,n,e){const t=en(i.getSizes(),n);i.setSizes(t),i.removeSizes(e)}function ai(i){X()?Be(i,N.MOBILE_SUCCESS,N.MOBILE_COLLAPSE):Be(i,N.DESKTOP_SUCCESS,N.DESKTOP_COLLAPSE)}function De(i){return i===N.MOBILE_SUCCESS[1]||i===N.DESKTOP_SUCCESS[1]}const re=50;class di extends u{constructor(){super(...arguments);o(this,"floorAdhesionSlotName","floor_adhesion");o(this,"containerRendered",!1);o(this,"adEngine");o(this,"adNodeManager");o(this,"closeButtonElement");o(this,"collapseEventSubscriber",new ce(1));o(this,"closeButtonOnClickEventSubscriber",new ce(1));o(this,"observer");o(this,"hooks",{onAfterAdNodeManagerInit:e=>{this.adNodeManager=e},onAdEngineInit:e=>{this.adEngine=e,this.addSlotRenderEndedFloorAdhesionListener(e),k()&&this.api.block()}});o(this,"api",{block:()=>{try{h(this.adNodeManager,"adNodeManager is not defined"),this.adNodeManager.blockSlot(this.floorAdhesionSlotName)}catch(e){console.warn(`Could not block the slot: ${e}`)}},unblock:async()=>{var t,r,s;(t=this.adNodeManager)==null||t.unblockSlot(this.floorAdhesionSlotName);const e=(r=this.adNodeManager)==null?void 0:r.getAdNodeByName(this.floorAdhesionSlotName);e&&(ai(e),await((s=this.adEngine)==null?void 0:s.requestRender([e])))},onCollapse:e=>this.collapseEventSubscriber.subscribe(e),onClose:e=>this.closeButtonOnClickEventSubscriber.subscribe(e)})}startObservingSizeChanges(e,t){const r=t.getElement();r&&(this.observer=new ResizeObserver(s=>{s.forEach(a=>{if(a.target!==r)return;const d=a.contentRect.height;this.render(e,t,d)})}),this.observer.observe(r))}getWrapperId(e){var t,r,s;return(s=(r=(t=e==null?void 0:e.getSlotConfig().dynamic)==null?void 0:t.single)==null?void 0:r.wrapper)==null?void 0:s.id}getFloorAdhesionWrapper(e){const t=this.getWrapperId(e);h(t,"floorAdhesionWrapperId is not defined");const r=document.getElementById(t);return h(r,"floorAdhesionWrapper is not defined"),r}createAndAppendCloseButton(e,t){this.closeButtonElement=oi(()=>{e.style.display="none";const r=t.getRenderCount();this.adNodeManager.removeAdNode(t),f(R.SLOT_FORCE_CLOSE_INFO,{slotName:this.floorAdhesionSlotName,rv:r||void 0}),this.closeButtonOnClickEventSubscriber.notify()}),e.appendChild(this.closeButtonElement)}removeCloseButton(){this.closeButtonElement&&(this.closeButtonElement.remove(),this.closeButtonElement=void 0)}isFirstRenderOfBigAd(e){return!this.containerRendered&&e>re}isRefreshToSmallerAd(e){return this.containerRendered&&e<=re&&!De(e)}isRefreshToBiggerAd(e){return this.containerRendered&&(e>re||De(e))&&!this.closeButtonElement}render(e,t,r){this.containerRendered||e.classList.add("add-background"),this.isFirstRenderOfBigAd(r)?this.createAndAppendCloseButton(e,t):this.isRefreshToSmallerAd(r)?this.removeCloseButton():this.isRefreshToBiggerAd(r)&&this.createAndAppendCloseButton(e,t),this.containerRendered=!0}collapse(e){const t=e.getElement(),r=this.getFloorAdhesionWrapper(e);r.style.display="none",t&&(t.style.height="0px"),this.containerRendered=!1,this.collapseEventSubscriber.notify(),this.observer&&(this.observer.disconnect(),this.observer=void 0)}addSlotRenderEndedFloorAdhesionListener(e){e.gptWrapper.addSlotEventListener(this.floorAdhesionSlotName,"slotRenderEnded",t=>{var s;const r=(s=this.adNodeManager)==null?void 0:s.getAdNodeByName(this.floorAdhesionSlotName);if(r){if(t.isEmpty){this.collapse(r);return}this.observer||this.startObservingSizeChanges(this.getFloorAdhesionWrapper(r),r)}})}}const ci=/^sse-(.+?)-(control|variant\d+)$/;function li(){const i=document.documentElement.classList;for(const n of i){const e=n.match(ci);if(e){const[,t,r]=e;return`${t}-${r}`}}}function ui(){var i,n;return((n=(i=window.fandomHost)==null?void 0:i.browser)==null?void 0:n.split(" ")[0])??""}class gi extends u{constructor(e){super();o(this,"hooks",{onInitPageTargeting:e=>{const t={odyssey:["1",`1_${Ut()}`],odyssey_version:He(),product:"fandom",uap:"none",uap_c:"none",labrador:this.activeLabradorKeyValues,dmn:$e().replace(/\./g,""),hostpre:Ct()??void 0,exp_bucket:Nt(),experiment_groups:this.getExperimentGroups()};Object.assign(e,t,this.getTargetingFromFandomContext(),this.getTargetingFromFandomHost(),this.getTargetingFromLegacyAdsContext())},onBiddersInit:e=>{const t={...this.getTargetingFromFandomContextTracking(),...this.getTargetingFromFandomContextTargeting()};Object.entries(t).forEach(([r,s])=>{e.gptWrapper.setTargeting(r,s)})},onBeforeFirstCallAdsRequest:e=>{const{ppid:t}=this.getTargetingFromFandomContextTracking();t&&e.updatePublisherProvidedId(t)}});this.activeLabradorKeyValues=e}getRating({esrb:e=[],mpa:t=[]}){const r=[];for(const s of e)r.push(`esrb:${s}`);for(const s of t)r.push(`mpa:${s}`);return r}getS2PageType(e){const t=(e==null?void 0:e.pageType)??"article";if(t==="article"){if(k(e))return`wv-${t}`;if(pt())return`${t}-ic`}return t}getTargetingFromLegacyAdsContext(){var r;const{targeting:e={},opts:t={}}=((r=window.ads)==null?void 0:r.context)??{};return{s2:this.getS2PageType(e),original_host:t.isGamepedia===!0?"gamepedia":"fandom"}}getTargetingFromFandomContextSite(){const e=v();if(!(e!=null&&e.site))return{};const{site:t}=e,r={},{categories:s,siteName:a="wikia",tags:d,directedAtChildren:c,taxonomy:l=[]}=t;return t.top1000&&(r.top="1k"),{...r,s0:l[0],s0c:s,s0v:l[1],s1:`_${a}`,kid_wiki:c?"1":"0",rating:this.getRating(d??{}),...d}}getTargetingFromFandomContextPage(){const e=v();if(!(e!=null&&e.page))return{};const{page:t}=e,{articleId:r,pageName:s,pageType:a,pageId:d,lang:c,wordCount:l}=t;return{artid:String(r),pageName:s,pageType:a,pageId:d.toString(),lang:c,word_count:String(l),wpage:s==null?void 0:s.toLowerCase()}}getTargetingFromFandomContextTracking(){const e=v();if(!(e!=null&&e.tracking))return{};const{tracking:t}=e,r={};return t.pvNumber!==void 0&&(r.pv=t.pvNumber.toString()),t.pvNumberGlobal!==void 0&&(r.pvg=t.pvNumberGlobal.toString()),t.pvUID!==void 0&&(r.pvuid=t.pvUID),t.ppid!==void 0&&(r.ppid=t.ppid),r}getTargetingFromFandomContextTargeting(){const e=v();if(!(e!=null&&e.targeting))return{};const{targeting:t}=e,r={};return t.brand!==void 0&&(r.brand=t.brand),t.adGroup!==void 0&&(r.adGroup=t.adGroup.split(",")),r}getTargetingFromFandomContext(){return{...this.getTargetingFromFandomContextPage(),...this.getTargetingFromFandomContextSite(),...this.getTargetingFromFandomContextTracking(),...this.getTargetingFromFandomContextTargeting()}}getExperimentGroups(){const e=li();return e?[e]:[]}getTargetingFromFandomHost(){var t,r,s;const e=X();return{device:((t=window.fandomHost)==null?void 0:t.device)??"desktop",geo:((s=(r=window.fandomHost)==null?void 0:r.geo)==null?void 0:s.country)??"none",is_mobile:e?"1":"0",skin:`ucp_${e?"mobile":"desktop"}`,browser:ui()}}}class hi extends u{constructor(){super(...arguments);o(this,"hooks",{onBeforeFirstCallAdsRequest(e){e.addEventListener("slotRenderEnded",t=>{t.slot.getSlotElementId()==="top_leaderboard"&&performance.mark("top_leaderboard_rendered")})}})}}function pi(i){return i.offsetTop>=window.innerHeight}const se={fandomdesktop:".mw-parser-output",fandommobile:".mw-parser-output",default:"#content"};function fi(i){return i?se[i]??se.default:se.default}const mi=970;class Ei extends u{constructor(){super();o(this,"contentWidth");o(this,"hooks",{onAfterAdNodeManagerInit:(e,t)=>{Object.values(t).forEach(r=>{var s;if((s=r==null?void 0:r.dynamic)!=null&&s.repeat){const a=r.dynamic.repeat,d=[...document.querySelectorAll(a.selector)];let c=null;const l=d.filter(g=>{if(this.shouldPlaceSlotOnAnchor(g,c))return c=g,!0}),m=Math.min(a.max??Number.MAX_SAFE_INTEGER,l.length);for(let g=0;g<m;g++){const p=this.createSlotConfig(r,g+1),te=l[g],B=document.createElement("div"),Se=document.createElement("div");B.classList.add(r.name),B.appendChild(Se),Se.id=p.name,te[a.insertMethod](B),e.createAdNode(p.name,p)}}})}});this.contentWidth=this.calculateContentWidth()}createSlotConfig(e,t){return{...e,name:`${e.name}_${t}`}}calculateContentWidth(){const e=document.querySelector(fi(ee()));return e?e.clientWidth:mi}shouldPlaceSlotOnAnchor(e,t){if(!pi(e)||e.offsetWidth<this.contentWidth)return!1;const r=window.innerHeight;if(t!==null){const s=t.offsetTop+r;if(e.offsetTop<s)return!1}return!0}}class le extends u{constructor(e={}){super();o(this,"active",!0);o(this,"hooks",{onAdEngineInit:e=>{e.gptWrapper.addEventListener("slotRenderEnded",()=>{}),e.gptWrapper.addEventListener("impressionViewable",t=>{this.scheduleRefresh(t.slot,e)})}});o(this,"api",{stop:()=>{this.active=!1}});this.config=e}refreshWhenBackInViewport(e,t){const r=t.gptWrapper.addSlotEventListener(e.getSlotName(),"slotVisibilityChanged",s=>{s.inViewPercentage>=50&&(this.active&&t.requestRender([e]),r())})}refreshOrAddListener(e,t){this.active&&(e.isInViewport()?t.requestRender([e]):this.refreshWhenBackInViewport(e,t))}scheduleRefresh(e,t){const r=e.getSlotElementId(),s=t.adNodeManager.getAdNodeByName(r);h(s,`Cannot schedule refresh. AdNode for slot ${r} not found`),setTimeout(()=>{s.isRefreshable()&&this.refreshOrAddListener(s,t)},this.config.icRefreshTimeoutMS??3e4)}}const bi={cache:{url:"https://prebid-server.rubiconproject.com/cache",ignoreBidderCacheKey:!0},s2sConfig:[]},Si={accountId:"7450",bidders:["mgnipbs"],defaultVendor:"rubicon",coopSync:!0,userSyncLimit:8,defaultTTL:300,timeout:300,allowUnknownBidderCodes:!0,extPrebid:{cache:{vastxml:{returnCreative:!1}},bidders:{mgnipbs:{wrappername:"7450_Web_Server"}}}};class Ai extends u{constructor(e={}){super();o(this,"hooks",{onBiddersInit:()=>{if(this.config.icPrebidMagniteS2s){const e=this.usePlugin(_);e==null||e.addPrebidReadyCallback(t=>{t.setConfig(bi)}),e==null||e.addPrebidReadyCallback(t=>{t.mergeConfig({s2sConfig:[Si]})})}}});this.config=e}static isEnabled(e){return!!(e!=null&&e.icPrebidMagniteS2s)}}function Ti(i,n=100,e=!1){let t,r,s;function a(...d){const c=Date.now()-r;c<n&&c>=0?t=setTimeout(()=>a(...d),n-c):(t=void 0,e||(s=i(...d)))}return(...d)=>{r=Date.now();const c=e&&!t;return t??(t=setTimeout(()=>a(...d),n)),c&&(s=i(...d)),s}}class fe{constructor(n=(e=>(e=window.fandomHost)==null?void 0:e.app)()??""){o(this,"SELECTORS_TO_MARGIN_BY_APP",{fandomdesktop:"body.skin-fandomdesktop .main-container .fandom-community-header__background",fandommobile:"body.skin-fandommobile nav.mobile-community-bar"});o(this,"ALTERNATIVE_MARGIN_SELECTORS",{fandomdesktop:".community-header-wrapper",fandommobile:""});o(this,"observer");o(this,"activated",!1);this.currentApp=n}getElementBySelectorForApp(n){const e=n[this.currentApp];return e?document.querySelector(e):null}changeElementToMarginForFullScreenBackgrounds(n){const e=this.getElementBySelectorForApp(this.ALTERNATIVE_MARGIN_SELECTORS);return n.classList.contains("fullScreen")?e:n}activate(n){this.activated=!0;const e=this.getElementBySelectorForApp(this.SELECTORS_TO_MARGIN_BY_APP);if(!e)return;const t=this.changeElementToMarginForFullScreenBackgrounds(e),r=Ti(s=>{requestAnimationFrame(()=>{for(const a of s){const d=a.target.clientHeight;this.activated&&(t.style.marginTop=`${d}px`)}})});this.observer=new ResizeObserver(r),this.observer.observe(n)}reset(){var t;const n=this.getElementBySelectorForApp(this.SELECTORS_TO_MARGIN_BY_APP),e=this.changeElementToMarginForFullScreenBackgrounds(n);e&&(e.style.marginTop=""),this.activated=!1,(t=this.observer)==null||t.disconnect()}}const q="top_leaderboard",ue={DESKTOP:[3,3],MAX:[3,3],MOBILE:[2,2]},Ii=250;function $(i){var n,e;return((e=(n=i.slot)==null?void 0:n.getSlotElementId)==null?void 0:e.call(n))===q}function _i(i){if(i.size===null||typeof i.size=="string")return!1;if(Array.isArray(i.size)&&i.size.length>=2){const[n,e]=i.size;return ae([n,e],ue.DESKTOP)||ae([n,e],ue.MOBILE)}return!1}function wi(i){return i.isEmpty||!$(i)}function vi(i){if(i==="fandomdesktop")return S(async()=>{const{TopBoxadHandler:n}=await import("./TopBoxadHandler-u-duZz3H.js");return{TopBoxadHandler:n}},[]).then(({TopBoxadHandler:n})=>{new n().applySticky()}).catch(n=>{console.error("Failed to load TopBoxadHandler:",n)})}class ft extends u{constructor(){super(...arguments);o(this,"hasFiredInContentVideoInitCallback",!1);o(this,"initOnceEventSubscriber",new ce(1));o(this,"api",{initOnce:()=>{this.hasFiredInContentVideoInitCallback||(this.hasFiredInContentVideoInitCallback=!0,this.initOnceEventSubscriber.notify())},registerInContentPlayerInitCallback:e=>{this.initOnceEventSubscriber.subscribe(e)}})}}const yi=1e10;function Ci(){return Math.floor(Math.random()*yi)+1}function Pi(){return["output=xml_vast4","env=vp","gdfp_req=1","impl=s","unviewed_position_start=1",`url=${encodeURIComponent(window.location.href)}`,`description_url=${encodeURIComponent(window.location.href)}`,`correlator=${Ci()}`]}function Ri(){var n,e;const i=(e=(n=v())==null?void 0:n.tracking)==null?void 0:e.ppid;return i?[`ppid=${i}`]:[]}function Ni(i){if(!i)return"";const n=i.sizes;return Array.isArray(n)?n.map(e=>e.toString().replace(",","x")).join("|"):"640x480"}function Li(i){window.ads&&i&&(window.ads.runtime=window.ads.runtime??{},window.ads.runtime.video={adUnit:i})}const Oi="https://pubads.g.doubleclick.net/gampad/ads?";class ge extends u{constructor(e={}){super();o(this,"consentData");o(this,"resolvedState",Promise.withResolvers());o(this,"adEngine");o(this,"api",{get:async(e="featured",t)=>{var s,a;const r=(s=this.adEngine)==null?void 0:s.adNodeManager.getAdNodeByName(e);return r?(await((a=this.adEngine)==null?void 0:a.requestBids([r])),await this.waitForResolvedState(),`${Oi}${this.getParams(t,r).join("&")}`):""},getAdUnitPath:(e="featured")=>{var r;const t=(r=this.adEngine)==null?void 0:r.adNodeManager.getAdNodeByName(e);return(t==null?void 0:t.getAdUnitPath())??""},getTargetingParams:async(e="featured",t)=>{var s,a;const r=(s=this.adEngine)==null?void 0:s.adNodeManager.getAdNodeByName(e);return r?(await((a=this.adEngine)==null?void 0:a.requestBids([r])),await this.waitForResolvedState(),this.buildCustomParams(t,r)):""},getPageTargeting:()=>{var e;return((e=this.adEngine)==null?void 0:e.gptWrapper.getAllTargeting({raw:!1}))??{}},getSlotTargeting:e=>{var t;return((t=this.adEngine)==null?void 0:t.gptWrapper.getAllSlotTargeting(e,{raw:!1}))??{}},setAdUnitRuntimeVariable:(e="incontent_player")=>{const t=this.api.getAdUnitPath(e)??"";Li(t)},unblockVideo:()=>{this.resolvedState.resolve()}});o(this,"hooks",{onConsentUpdated:e=>{this.consentData=e},onAfterAdNodeManagerInit:e=>{this.createAdNodeForPageType(e),this.config.icUAPJWPlayer||this.api.unblockVideo()},onAdEngineInit:e=>{this.adEngine=e}});this.config=e}createAdNodeForPageType(e){k()&&e.createAdNode("featured"),pt()&&e.createAdNode("incontent_player")}getParams(e,t){return[...Pi(),...Ri(),...this.getPrivacyParams(),...this.getSlotParams(t),...this.getCustomParams(e,t),...this.getVideoParams()].filter(Boolean)}getSlotParams(e){const t=e.getAdUnitPath(),r=Ni(e.getSlotConfig());return[`iu=${t}`,`sz=${r}`]}getPrivacyParams(){const{coppa:e,consentApi:t,consentString:r=""}=this.consentData??{},s=[];return t==="usp"?s.push(`us_privacy=${r}`,"gdpr=0"):t==="tcf"&&s.push(`gdpr_consent=${r}`,"gdpr=1"),e===!0&&s.push("tfcd=1"),s}buildCustomParams(e,t){const r=(t==null?void 0:t.getAllTargeting())??{},s=Object.entries(r).map(([c,l])=>`${c}=${l.join(",")}`).join("&"),a=this.getPageTargetingParams();return[`player=${this.getVideoPlayer(e)}`,"rv=1",s,...a,...this.getUAPParams()].filter(Boolean).join("&")}getCustomParams(e,t){const r=this.buildCustomParams(e,t);return[`cust_params=${encodeURIComponent(r)}`]}getPageTargetingParams(){var t;const e=((t=this.adEngine)==null?void 0:t.gptWrapper.getAllTargeting({raw:!1}))??{};return Object.entries(e).map(([r,s])=>`${r}=${s}`)}getVideoPlayer(e){return e??(this.config.icFeaturedVideoPlayer==="Connatix"?"cnx":"jwp")}getVideoParams(){return[`vpos=${this.getPosition()}`]}getUAPParams(){var r,s,a,d;const e=(s=(r=this.adEngine)==null?void 0:r.gptWrapper)==null?void 0:s.getTargeting("uap"),t=(d=(a=this.adEngine)==null?void 0:a.gptWrapper)==null?void 0:d.getTargeting("uap_c");return e&&t?[`uap=${e[0]}`,`uap_c=${t[0]}`]:[]}getPosition(){return"preroll"}waitForResolvedState(){return this.resolvedState.promise}}class ki{constructor(n=new fe){o(this,"activating",!1);o(this,"feature");o(this,"killDeactivation",!1);o(this,"onRemoveStickinessCallback");this.marginApplier=n}activate(n){this.activating||this.feature||(this.activating=!0,S(async()=>{const{StickyFeature:e}=await import("./StickyFeature-CUluaCAe.js");return{StickyFeature:e}},[]).then(({StickyFeature:e})=>{this.feature=new e(this.marginApplier),this.feature.activate(n),this.activating=!1,this.onRemoveStickinessCallback&&this.feature.onRemoveStickiness(this.onRemoveStickinessCallback)}).catch(()=>{throw this.activating=!1,new Error("Failed to load StickyFeature")}))}addOnRemoveStickiness(n){if(!this.feature){this.onRemoveStickinessCallback=n;return}this.feature.onRemoveStickiness(n)}deactivate(){if(this.killDeactivation){this.killDeactivation=!1;return}if(!this.feature){setTimeout(()=>{this.deactivate()},100);return}this.feature.removeStickiness()}reactivate(n,e){if(this.killDeactivation=!0,!this.feature){this.activate({...n,disableAutoUnstick:e});return}this.feature.activate({...n,disableAutoUnstick:e})}}class Bi{constructor(n=new fe){o(this,"activating",!1);o(this,"feature");this.marginApplier=n}activate(n,e){this.activating||this.feature||(this.activating=!0,S(async()=>{const{SkyboxFeature:t}=await import("./SkyboxFeature-D4TFXID9.js");return{SkyboxFeature:t}},[]).then(({SkyboxFeature:t})=>{this.feature=new t(this.marginApplier),this.feature.activate(n,e),this.activating=!1}).catch(()=>{throw this.activating=!1,new Error("Failed to load SkyboxFeature")}))}moveToResolvedState(n){this.feature&&this.feature.makeStateResolved(n)}}class Di{constructor(n){o(this,"activating",!1);o(this,"feature");this.adNodeManager=n}activate(n){this.activating||this.feature||(this.activating=!0,S(async()=>{const{SlotManagerFeature:e}=await import("./SlotManagerFeature-SVdkR6ey.js");return{SlotManagerFeature:e}},[]).then(({SlotManagerFeature:e})=>{this.feature=new e(this.adNodeManager),this.feature.activate(n.enabledSlots??[]),this.activating=!1}).catch(()=>{throw this.activating=!1,new Error("Failed to load SlotManagerFeature")}))}}class Fi{constructor(){o(this,"activating",!1);o(this,"feature")}activate(n,e){this.activating||this.feature||(this.activating=!0,S(async()=>{const{VideoBannerFeature:t}=await import("./VideoBannerFeature-CGRJzHom.js");return{VideoBannerFeature:t}},[]).then(({VideoBannerFeature:t})=>{this.feature=new t,this.feature.activate(n,e),this.activating=!1}).catch(()=>{throw this.activating=!1,new Error("Failed to load VideoBannerFeature")}))}}class Mi extends u{constructor(e={},t=new fe,r){super();o(this,"adNodeManager");o(this,"gpt");o(this,"defaultStickyTlbPromiseResolver",()=>{});o(this,"defaultStickyTlbPromiseRejecter",()=>{});o(this,"featuresFlags",{skyboxResolved:!1});o(this,"defaultStickyTlbApplied",!1);o(this,"stickyActivator");o(this,"skyboxActivator");o(this,"slotManagerActivator");o(this,"videoFeatureActivator");o(this,"tentpoleActivator",Promise.withResolvers());o(this,"hasFanTakeoverLoaded",null);o(this,"api",{activate:async e=>{var t;e.slotName??(e.slotName=q),this.defaultStickyTlbPromiseRejecter(),e.skybox&&((t=this.usePlugin(le))==null||t.stop()),this.activateTentpoleFeature(e),this.activateStickyFeature(e),this.activateSlotManagerFeature(e),this.activateSkyboxFeature(e),this.activateVideoFeature(e)},onRemoveStickiness:e=>{var t;(t=this.stickyActivator)==null||t.addOnRemoveStickiness(e)}});o(this,"hooks",{onAfterAdNodeManagerInit:e=>{var t;this.adNodeManager=e,k()&&((t=this.adNodeManager.getAdNodeByName(q))==null||t.removeSizes(ue.MAX,pe.LESS_THAN_OR_EQUAL))},onBeforeAdsRequest:e=>{this.gpt=e,this.activateOrUnblockProperPluginOnDefaultTopSlotRender(e)}});this.config=e,this.marginApplier=t,this.defaultStickyTlbPromise=r,this.defaultStickyTlbPromise??(this.defaultStickyTlbPromise=new Promise((s,a)=>{this.defaultStickyTlbPromiseResolver=s,this.defaultStickyTlbPromiseRejecter=a})),document.body.classList.add("odyssey","odyssey-top-strategy")}activateStickyFeature(e){!e.sticky&&this.defaultStickyTlbApplied||(this.stickyActivator??(this.stickyActivator=new ki(this.marginApplier)),this.stickyActivator.activate(e))}activateSkyboxFeature(e){var t;e.skybox&&(this.skyboxActivator??(this.skyboxActivator=new Bi(this.marginApplier)),(t=this.stickyActivator)==null||t.deactivate(),this.skyboxActivator.activate(e,()=>{var r;this.featuresFlags.skyboxResolved=!0,(r=this.stickyActivator)==null||r.reactivate(e,!0)}))}activateSlotManagerFeature(e){var t;!e.takeover||!((t=e.enabledSlots)!=null&&t.length)||(this.slotManagerActivator=new Di(this.adNodeManager),this.slotManagerActivator.activate({enabledSlots:e.enabledSlots}))}activateTentpoleFeature(e){var s,a,d,c;if(typeof e.tentpole!="object"){this.tentpoleActivator.resolve();return}const{tentpole:t}=e,r=l=>l?l.toString():"none";(s=this.gpt)==null||s.setTargeting("uap",r(t==null?void 0:t.lineItemId)),(a=this.gpt)==null||a.setTargeting("uap_c",r(t==null?void 0:t.creativeId)),(d=this.usePlugin(le))==null||d.stop(),(c=this.usePlugin(ge))==null||c.unblockVideo(),vi(ee())}activateOrUnblockProperPluginOnDefaultTopSlotRender(e){e.addEventListener("slotRenderEnded",async t=>{var r;this.handleUnblockVideoOnDefaultSlotRender(t),!(!X()&&!this.config.icForceStickyTlb&&wi(t))&&(!X()&&$(t)&&((r=this.defaultStickyTlbPromise)==null||r.then(()=>{this.defaultStickyTlbApplied=!0,this.activateStickyFeature({id:"unknown",slotName:q,sticky:!0})}),setTimeout(()=>{this.defaultStickyTlbPromiseResolver()},100)),this.handleInContentVideo(t))})}handleUnblockVideoOnDefaultSlotRender(e){if(!$(e))return;const t=()=>{var r;(r=this.usePlugin(ge))==null||r.unblockVideo()};U(this.tentpoleActivator.promise,Ii).then(t,t)}handleInContentVideo(e){if($(e)&&(this.hasFanTakeoverLoaded=_i(e),!this.hasFanTakeoverLoaded&&!k())){const t=this.usePlugin(ft);t==null||t.initOnce()}}activateVideoFeature(e){e.videoUrl&&(this.videoFeatureActivator??(this.videoFeatureActivator=new Fi),this.videoFeatureActivator.activate(e,()=>{var t;(t=this.skyboxActivator)==null||t.moveToResolvedState(e)}))}}function mt(i){return i.getSlotConfig().sizes.map(e=>me(e))}function me(i){return i?Array.isArray(i)?i.join("x"):i:""}function xi(i,n,e){var r;const t=(r=i.getResponseInformation)==null?void 0:r.call(i);if(t)return{advertiserId:t.advertiserId,creativeId:t.creativeId,lineItemId:t.lineItemId,orderId:t.campaignId,selectedSize:e,configuredSizes:mt(n)}}function oe(i,n,e,t){const r=n.getSlotElementId(),s=e.getAdNodeByName(r);if(!s)return;const a={slotName:r,slotInfo:xi(n,s,t),rv:s.getRenderCount()};f(i,a)}function Fe(i,n){f(i,{time:performance.now(),slotName:n})}const Ui=/[?&]prev_iu_szs=([^&#]*)/;function Wi(i){if(!i)return"";const n=i.match(Ui);return n?decodeURIComponent(n[1]):""}function Vi(i){var t;if(!i)return[];const n=((t=i.getContentUrl)==null?void 0:t.call(i))??"",e=Wi(n);return e?e.split("|").filter(Boolean):[]}function Gi(i,n,e,t){const r=n.getSlotElementId(),s=e.getAdNodeByName(r);if(!s)return;const a={slotName:r,slotInfo:{...ji(n),selectedSize:zi(t),configuredSizes:mt(s),parsedSizes:Vi(n)}};f(i,a)}function zi(i){if(i!==void 0)return i===null?null:me(i)}function ji(i){var e;const n=(e=i.getResponseInformation)==null?void 0:e.call(i);return n?{advertiserId:n.advertiserId,creativeId:n.creativeId,lineItemId:n.lineItemId,orderId:n.campaignId}:{advertiserId:void 0,creativeId:void 0,lineItemId:void 0,orderId:void 0}}class Hi{constructor(n,e){o(this,"listener",this.detectClickOnIframe.bind(this));this.slotName=n,this.callbackOnDetection=e}init(){window.addEventListener("blur",this.listener)}detectClickOnIframe(){const n=document.activeElement;(n==null?void 0:n.closest(`div#${this.slotName}`))!==null&&(this.callbackOnDetection(),this.clearDetection())}clearDetection(){setTimeout(()=>{document.activeElement.blur()},100)}detach(){window.removeEventListener("blur",this.listener)}}function Et(i,n,e,t){return{slotName:i.adUnitCode,baseSlotName:(e==null?void 0:e.getBaseSlotName())??i.adUnitCode,rv:(e==null?void 0:e.getRenderCount())??void 0,bidInfo:{status:n,bidderName:i.bidderCode,size:`${i.width}x${i.height}`,price:`${i.cpm}`,timeToRespond:i.timeToRespond,auctionId:i.auctionId,rejectionReason:i.rejectionReason,fullAuction:t}}}function Ee(i,n,e,t){return{slotName:i.adUnitCode,baseSlotName:(e==null?void 0:e.getBaseSlotName())??i.adUnitCode,rv:(e==null?void 0:e.getRenderCount())??void 0,bidInfo:{status:n,bidderName:i.bidder,auctionId:i.auctionId,size:void 0,price:void 0,timeToRespond:void 0,rejectionReason:void 0,fullAuction:t}}}function qi(i,n,e,t){if(!t)return;const r=Et(i,"on_time",n,e);f(w.BIDDER_RESPONSE,r)}function $i(i,n,e,t){if(!t)return;const r=Et(i,"rejected",n,e);f(w.BIDDER_RESPONSE,r)}function Ki(i,n,e,t){if(!t)return;const r=Ee(i,"unknown",n,e);f(w.BIDDER_RESPONSE,r)}function Yi(i,n,e,t){if(!t)return;const r=Ee(i,"timedout",n,e);f(w.BIDDER_RESPONSE,r)}function Qi(i,n,e,t){if(!t)return;const r=Ee(i,"declined",n,e);f(w.BIDDER_RESPONSE,r)}function D(i,n){if(!n)return;const e={slotName:"error",baseSlotName:"error",rv:void 0,bidInfo:{status:"error",bidderName:"error",auctionId:void 0,size:void 0,price:void 0,timeToRespond:void 0,rejectionReason:void 0,fullAuction:i}};f(w.BIDDER_RESPONSE,e)}const Xi={auctionEndWait:100,percentFullAuctions:.01,percentSampleTarget:.1};class Ji{constructor(n,e,t=Xi){o(this,"pbjs");o(this,"adNodeManager");o(this,"config");o(this,"fullAuction");o(this,"sampleRate");o(this,"pendingAuctions",{});this.pbjs=n,this.adNodeManager=e,this.config=t,this.validateSampling(t.percentFullAuctions,t.percentSampleTarget),this.fullAuction=Math.random()<t.percentFullAuctions,x("force_tracking")&&(this.fullAuction=!0),this.fullAuction==!0?this.sampleRate=1:this.sampleRate=(t.percentSampleTarget-t.percentFullAuctions)/(1-t.percentFullAuctions),this.monitorAuctionInit(),this.monitorTimedOutRequests(),this.monitorAuctionEnd()}validateSampling(n,e){if(n>e)throw Error("percentFullAuctions must be less than the percentSampleTarget");if(e>1||e<0)throw Error("percentSampleTarget must be between 0 and 1");if(n>1||n<0)throw Error("percentFullAuctions must be between 0 and 1")}bidIsSampled(){return Math.random()<this.sampleRate}monitorAuctionInit(){this.pbjs.onEvent("auctionInit",n=>{const e={bidState:{}};n.bidderRequests.forEach(t=>{try{t.bids.forEach(r=>{e.bidState[P(r)]="requested"})}catch{console.warn("Error tracking initial auctionInit state for bidRequest:",t)}}),this.pendingAuctions[n.auctionId]=e})}monitorAuctionEnd(){this.pbjs.onEvent("auctionEnd",n=>{this.recordBidsReceived(n),this.recordBidsRejected(n),setTimeout(()=>{this.recordNoBids(n),this.recordUnknownBids(n),delete this.pendingAuctions[n.auctionId]},this.config.auctionEndWait)})}monitorTimedOutRequests(){this.pbjs.onEvent("bidTimeout",n=>{n.forEach(e=>{try{const t=this.pendingAuctions[e.auctionId],r=this.adNodeManager.getAdNodeByName(e.adUnitCode);t.bidState[P(e)]="timedout",Yi(e,r,this.fullAuction,this.bidIsSampled())}catch{console.warn("Error recording bidTimeout:",e),D(this.fullAuction,this.bidIsSampled())}})})}recordBidsReceived(n){const e=this.pendingAuctions[n.auctionId];n.bidsReceived.forEach(t=>{try{const r=this.adNodeManager.getAdNodeByName(t.adUnitCode);e.bidState[P(t)]="on_time",qi(t,r,this.fullAuction,this.bidIsSampled())}catch(r){console.error(r),console.warn("Error recording bidReceived:",t),D(this.fullAuction,this.bidIsSampled())}})}recordBidsRejected(n){const e=this.pendingAuctions[n.auctionId];n.bidsRejected.forEach(t=>{try{e.bidState[P(t)]="rejected";const r=this.adNodeManager.getAdNodeByName(t.adUnitCode);$i(t,r,this.fullAuction,this.bidIsSampled())}catch{console.warn("Error recording bidRejected:",t),D(this.fullAuction,this.bidIsSampled())}})}recordNoBids(n){const e=this.pendingAuctions[n.auctionId];n.noBids.forEach(t=>{try{const r=P(t);if(e.bidState[r]!="timedout"){e.bidState[r]="declined";const s=this.adNodeManager.getAdNodeByName(t.adUnitCode);Qi(t,s,this.fullAuction,this.bidIsSampled())}}catch{console.warn("Error recording no_bid",t),D(this.fullAuction,this.bidIsSampled())}})}recordUnknownBids(n){try{const e=n.bidderRequests.flatMap(r=>r.bids),t=this.pendingAuctions[n.auctionId];for(const[r,s]of Object.entries(t.bidState))if(s==="requested"){const a=e.find(d=>P(d)===r);if(a){const d=this.adNodeManager.getAdNodeByName(a.adUnitCode);Ki(a,d,this.fullAuction,this.bidIsSampled())}else console.warn("Could not find bid data to report"),D(this.fullAuction,this.bidIsSampled())}}catch{console.warn("Error recording unknown bids")}}}function P(i){return`${i.bidder}-${i.transactionId}`}class Zi extends u{constructor(){super(...arguments);o(this,"auctionTracker");o(this,"SLOTS_ELIGIBLE_TO_LOADING_TIME_TRACK",["top_leaderboard","top_boxad","floor_adhesion","interstitial"]);o(this,"clickTrackingSlotMap",new Map);o(this,"slotsAlreadyTrackedForLoadTime",{requested:new Map,rendered:new Map});o(this,"hooks",{onInitPageTargeting:()=>{f(F.AE_INIT,{time:performance.now()})},onAdEngineInit:e=>{document.addEventListener("visibilitychange",this.onPageVisibilityChange.bind(this,e)),this.onPageVisibilityChange(e)},onBiddersInit:e=>{var t;(t=this.usePlugin(_))==null||t.addPrebidReadyCallback(r=>{this.auctionTracker=new Ji(r,e.adNodeManager)})},onBeforeFirstCallAdsRequest:(e,t)=>(this.onGptSlotRequested(e,t),this.onGptSlotRendered(e,t),this.onGptResponseReceived(e,t),e)});o(this,"api",{track:(e,t)=>{f(e,t)}})}isSlotEligibleToLoadingTimeTrack(e){return this.SLOTS_ELIGIBLE_TO_LOADING_TIME_TRACK.includes(e)}onGptSlotRequested(e,t){e.addEventListener("slotRequested",r=>{const s=r.slot,a=s.getSlotElementId();oe(R.SLOT_REQUESTED_INFO,s,t),this.isSlotEligibleToLoadingTimeTrack(a)&&(this.slotsAlreadyTrackedForLoadTime.requested.has(a)||(Fe(F.SLOT_REQUESTED,a),this.slotsAlreadyTrackedForLoadTime.requested.set(a,!0)))})}onGptSlotRendered(e,t){e.addEventListener("slotRenderEnded",r=>{if(r.isEmpty)return;const s=r.slot,a=s.getSlotElementId(),d=t.getAdNodeByName(a);d&&(oe(R.SLOT_RENDERED_INFO,s,t,me(r.size??"")),Gi(Ze.SLOT_SIZE_ESTABLISHED,s,t,r.size),this.attachClickTracking(a,d),this.isSlotEligibleToLoadingTimeTrack(a)&&(this.slotsAlreadyTrackedForLoadTime.rendered.has(a)||(Fe(F.SLOT_RENDERED,a),this.slotsAlreadyTrackedForLoadTime.rendered.set(a,!0))))})}onGptResponseReceived(e,t){e.addEventListener("slotResponseReceived",r=>{const s=r.slot;oe(R.SLOT_CODE_SERVED_INFO,s,t)})}onPageVisibilityChange(e){e.gptWrapper.setTargeting("is_bg",document.hidden?"1":"0")}attachClickTracking(e,t){if(this.clickTrackingSlotMap.has(e))return;const r=()=>{const a=t.getRenderCount(),d={slotName:e,rv:a};f(R.SLOT_CLICKED,d)},s=new Hi(e,r);s.init(),this.clickTrackingSlotMap.set(e,s)}}class er extends u{constructor(){super(...arguments);o(this,"adEngine");o(this,"adNodeManager");o(this,"refreshLock",!1);o(this,"galleryLeaderboard",null);o(this,"lightboxLeaderboardAdNode");o(this,"hooks",{onAfterAdNodeManagerInit:e=>{this.adNodeManager=e},onAdEngineInit:e=>{this.adEngine=e}});o(this,"api",{onLightboxOpen:()=>{this.galleryLeaderboard=document.querySelector(".gallery-leaderboard"),this.galleryLeaderboard&&this.renderOrRefreshAd()},onLightboxClose:()=>{this.galleryLeaderboard=null,this.toggleFloorAdhesion(!1)},onLightboxChange:()=>{this.renderOrRefreshAd()}})}setRefreshLock(e=2e3){this.refreshLock=!0,setTimeout(()=>{this.refreshLock=!1},e)}waitForFloorWrapper(e){const t=document.getElementById("floor_adhesion_wrapper");if(t){e(t);return}const r=new MutationObserver(()=>{const s=document.getElementById("floor_adhesion_wrapper");s&&(r.disconnect(),e(s))});r.observe(document.body,{childList:!0,subtree:!0})}toggleFloorAdhesion(e){this.waitForFloorWrapper(t=>{t.classList.toggle("hide-under-lightbox",e)})}getOrCreateLightboxLeaderboard(){var t;if(!this.galleryLeaderboard)return null;let e=document.getElementById("lightbox_leaderboard");return e||(e=document.createElement("div"),e.id="lightbox_leaderboard",this.galleryLeaderboard.prepend(e),this.lightboxLeaderboardAdNode??(this.lightboxLeaderboardAdNode=(t=this.adNodeManager)==null?void 0:t.createAdNode("lightbox_leaderboard"))),e}renderOrRefreshAd(){var r;if(this.refreshLock)return;const e=this.getOrCreateLightboxLeaderboard();if(!e)return;this.toggleFloorAdhesion(!0),e.classList.remove("is-loading");const t=document==null?void 0:document.getElementsByClassName("lightbox-wrapper-inner")[0];(r=t==null?void 0:t.classList)==null||r.add("with-ad"),this.bidAndRefreshLightboxLeaderboardAdNode()}async bidAndRefreshLightboxLeaderboardAdNode(){var e;this.setRefreshLock(),this.lightboxLeaderboardAdNode&&((e=this.adEngine)==null||e.requestRender([this.lightboxLeaderboardAdNode]))}}class tr extends u{constructor(){super(...arguments);o(this,"CLIENT_ID",17364);o(this,"PIXEL_URL",`https://tags.crwdcntrl.net/lt/c/${this.CLIENT_ID}/lt.min.js`);o(this,"isLoaded",!1);o(this,"TAXONOMY_TAGS_TO_KEEP",["gnre","media","pform","pub","theme","tv"]);o(this,"hooks",{onConsentUpdated:e=>{A(e)&&this.init()}})}mapTaxonomyToLotameBehaviorTags(e={}){const t=[];for(const[r,s]of Object.entries(e))if(this.TAXONOMY_TAGS_TO_KEEP.includes(r))for(const a of s)t.push(`${r}: ${a}`);return t}setupLotameTagInput(){var r,s;const e=(s=(r=v())==null?void 0:r.site)==null?void 0:s.tags;return{data:{behaviors:{med:e?this.mapTaxonomyToLotameBehaviorTags(e):[]}},config:{clientId:this.CLIENT_ID}}}setupLotameNamespaceConfig(){const e=this.setupLotameTagInput(),t=`lotame_${this.CLIENT_ID}`,r=e.config??{},s=window[t]={};s.config=r,s.data=e.data??{},s.cmd=s.cmd??[]}async loadLotameScript(){this.setupLotameNamespaceConfig();try{await I(this.PIXEL_URL),this.isLoaded=!0}catch(e){console.error("Failed to load Lotame script",e)}}static isEnabled(e){return!!(e!=null&&e.icLotame)}init(){this.isLoaded||this.loadLotameScript()}}class nr extends u{constructor(){super(...arguments);o(this,"scriptDomain","cdn.confiant-integrations.net");o(this,"propertyId","d-aIf3ibf0cYxCLB1HTWfBQOFEA");o(this,"isLoaded",!1);o(this,"trackBlock",(e,t,r,s,a,d)=>{if(d&&d.dfp){const c=d.dfp.s;console.debug(`Blocked ad on ${c}`)}});o(this,"hooks",{onConsentUpdated:e=>{A(e)&&this.init()}})}static isEnabled(e){return!!(e!=null&&e.icConfiant)}async loadConfiantScript(){const e=`//${this.scriptDomain}/${this.propertyId}/gpt_and_prebid/config.js`;try{await I(e),this.isLoaded=!0}catch(t){console.error("Failed to load Confiant script",t)}}setupConfiantWindowObject(){window.confiant=window.confiant??{},window.confiant.callback=this.trackBlock}init(){this.isLoaded||(this.setupConfiantWindowObject(),this.loadConfiantScript())}}const ir=1,Me={default:1187275693,v6_1:339079598},rr={default:"IntentIqObject",v6_1:"IntentIqObject61"};function sr(i){return{biddingPlatformId:ir,partnerAuctionId:i.auctionId,bidderCode:i.bidderCode,prebidAuctionId:i.auctionId,cpm:i.cpm,currency:i.currency}}function or(i){return`//script.wikia.nocookie.net/fandom-ae-assets/intentiq/${i}/IIQUniversalID.js`}function be(i){return i==="v6.1"}function ar(i){return rr[be(i)?"v6_1":"default"]}function bt(i){return window[ar(i)]}async function dr(i){await Y(()=>bt(i)!==void 0,{maxTries:10,exponentialTimeout:10})}function cr(i,n,e){const t=window.location.hostname.includes(".fandom.com")?"fandom.com":window.location.hostname;return be(i)?{partner:Me.v6_1,pbjs:e,timeoutInMillis:n,ABTestingConfigurationSource:"IIQServer",manualWinReportEnabled:!0,domainName:t,vrBrowserBlackList:["chrome"],abPercentage:97}:{partner:Me.default,pbjs:e,timeoutInMillis:n,ABTestingConfigurationSource:"percentage",manualWinReportEnabled:!0,domainName:t,vrBrowserBlackList:["chrome"]}}async function lr(i,n,e){return new Promise(t=>{const r=new n({...i,callback:(s,a)=>{a??(a="U"),e(r,a),t()}})})}async function ur(i,n,e){return new Promise(t=>{var a,d;const r=new n({...i,callback:()=>{t()}}),s=((d=(a=r==null?void 0:r.intentIqConfig)==null?void 0:a.abTesting)==null?void 0:d.currentTestGroup)??"U";e(r,s)})}async function gr(i,n,e,t){const r=cr(i,n,e),s=bt(i);if(s)return be(i)?lr(r,s,t):ur(r,s,t)}function hr(){const i=navigator.userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))/i);return i!==null&&i[1]==="Chrome"}const pr=1e3;class fr extends u{constructor(e){super();o(this,"consent",!1);o(this,"enabled",!1);o(this,"intentIqObject");o(this,"gptWrapper");o(this,"pbjs");o(this,"hooks",{onBiddersInit:()=>{var e;(e=this.usePlugin(_))==null||e.addPrebidReadyCallback(t=>{this.pbjs=t,this.initialize(this.pbjs)})},onConsentUpdated:e=>{this.consent=A(e),this.pbjs&&this.initialize(this.pbjs)},onAfterGptWrapperInit:e=>{this.gptWrapper=e}});this.config=e}static isEnabled(e){return!hr()&&e.icPrebidIntentIQ&&!!e.icPrebidIntentIQVersion&&!!e.icPrebidIntentIQTimeout}async initialize(e){if(this.enabled||!this.consent)return;await this.loadIntentIqLibrary(e);const t=({bid:r})=>{this.reportPrebidWin(r)};e.onEvent("adRenderSucceeded",t)}async loadIntentIqLibrary(e){try{await U(I(or(this.config.icPrebidIntentIQVersion)),pr),await dr(this.config.icPrebidIntentIQVersion),await gr(this.config.icPrebidIntentIQVersion,this.config.icPrebidIntentIQTimeout,e,(t,r)=>{this.enabled=!0,this.intentIqObject=t,this.setTargeting(r)})}catch(t){console.error("Failed to load Intent IQ script",t)}}setTargeting(e){h(this.gptWrapper,"GPT wrapper is not available"),e&&this.gptWrapper&&this.gptWrapper.setTargeting("intent_iq_group",e)}reportPrebidWin(e){if(!this.enabled||!this.intentIqObject)return;const t=sr(e);this.intentIqObject.reportExternalWin(t)}}class mr extends u{constructor(){super(...arguments);o(this,"PROPERTY_ID",12974);o(this,"CAPTIFY_PIXEL_URL",`https://p.cpx.to/p/${this.PROPERTY_ID}/px.js`);o(this,"isLoaded",!1);o(this,"hooks",{onConsentUpdated:e=>{A(e)&&this.init()}})}static isEnabled(e){return!!(e!=null&&e.icCaptify)}createCaptifyWindowObject(){const e=`captify_kw_query_${this.PROPERTY_ID}`;window[e]=""}async createAndInsertScript(){try{await I({src:this.CAPTIFY_PIXEL_URL,isAsyncOrDeferOtherwise:!1,node:"first"}),this.isLoaded=!0}catch(e){console.error("Failed to load Captify script",e)}}init(){this.isLoaded||(this.createCaptifyWindowObject(),this.createAndInsertScript())}}class Er extends u{constructor(){super(...arguments);o(this,"BRAND_METRICS_LIB_URL","//cdn.brandmetrics.com/tag/9097a5369e204e6eac53b45c7dde13c5/fandom.com_au.js");o(this,"firstAdRendered",!1);o(this,"hooks",{onAfterGptWrapperInit:e=>{this.init(e)}})}async loadBrandMetricsScript(){try{await I(this.BRAND_METRICS_LIB_URL)}catch(e){console.error("Failed to load Brand Metrics script.",e)}}static isEnabled(e){return!!(e!=null&&e.icBrandMetrics)}init(e){const t=()=>{this.firstAdRendered||(this.firstAdRendered=!0,e.removeEventListener("slotRenderEnded",t),this.loadBrandMetricsScript())};e.addEventListener("slotRenderEnded",t)}}const br="AU_SEG",Sr="auSegReady";var K=(i=>(i.MATCHES_SCRIPT_LOADED="audigent_matches_library_loaded",i.SEGMENTS_SCRIPT_LOADED="audigent_segment_library_loaded",i.SEGMENTS_READY="audigent_segments_ready",i))(K||{});const Ar="-1",xe="https://a.ad.gt/api/v1/u/matches/158",Ue="https://seg.ad.gt/api/v1/s/158";class Tr extends u{constructor(e){super();o(this,"isInitialized",!1);o(this,"segmentsScriptAdded",!1);o(this,"matchesScriptAdded",!1);o(this,"gptWrapper");o(this,"consent",!1);o(this,"hooks",{onConsentUpdated:e=>{this.consent=A(e),this.consent&&this.initialize()},onInitPageTargeting:e=>{this.consent&&(e.AU_SEG=this.getSegments())},onAfterGptWrapperInit:e=>{this.gptWrapper=e,this.updateTargeting()}});this.instantConfig=e,this.listenForSegmentUpdates(),this.addSegmentsScript()}static isEnabled(e){return!!e.icAudigent}sendTracking(e){const t={eventName:e,time:performance.now()};f(F.VENDOR_TIME_UPDATE,t)}getSegments(){var t;let e=Ar;return window.au_seg&&(e=(t=window.au_seg)==null?void 0:t.segments.slice(0,this.instantConfig.icAudigentSegmentLimit)),e}updateTargeting(){if(!this.gptWrapper||!this.consent)return;const e=this.getSegments();this.gptWrapper.setTargeting(br,e)}listenForSegmentUpdates(){document.addEventListener(Sr,()=>{this.updateTargeting(),this.sendTracking(K.SEGMENTS_READY)})}async addSegmentsScript(){if(!this.segmentsScriptAdded)try{await I(Ue),this.segmentsScriptAdded=!0,this.sendTracking(K.SEGMENTS_SCRIPT_LOADED)}catch(e){console.error(`Failed to load Audigent Segments Script ${Ue}`,e)}}async addMatchesScript(){if(!(this.matchesScriptAdded||!this.consent))try{await I(xe),this.matchesScriptAdded=!0,this.sendTracking(K.MATCHES_SCRIPT_LOADED)}catch(e){console.error(`Failed to load Audigent Matches Script ${xe}`,e)}}async initialize(){this.isInitialized||(this.updateTargeting(),await this.addMatchesScript(),this.isInitialized=!0)}}const M="-1",Ir="https://pub.doubleverify.com/signals/pub.json",_r="28150781",wr="DV1001654",We=window.location.href,vr={abs:M,bsc:M,ids:M},Ve=["top_leaderboard","top_boxad","incontent_boxad","bottom_leaderboard","incontent_leaderboard","gallery_leaderboard","featured","incontent_player","mpu_top","mpu-plus-top","cdm-zone-01","cdm-zone-02","cdm-zone-03","cdm-zone-04","cdm-zone-06"];class yr extends u{constructor(){super(...arguments);o(this,"adNodeManager");o(this,"gptWrapper");o(this,"consent",!1);o(this,"initialized",!1);o(this,"trackedSlots",{});o(this,"hooks",{onConsentUpdated:e=>{A(e)&&(this.consent=!0,this.initialize())},onAdEngineInit:e=>{this.gptWrapper=e.gptWrapper,this.adNodeManager=e.adNodeManager,this.initialize()}})}static isEnabled({icDoubleVerify:e}){return!!e}buildRequestUrl(){const e=new URL(Ir),t=e.searchParams;t.set("ctx",_r),t.set("cmp",wr),t.set("url",We);for(const r of Object.keys(this.trackedSlots))t.append(`adunits[${r}][]`,"");return e}async fetchData(){if(!this.gptWrapper||!this.adNodeManager||!this.consent)return;const e=this.buildRequestUrl();try{const t=await fetch(e,{headers:{referer:We}});if(t.status>=400)return;const r=await t.json();this.handleResponse(r)}catch(t){console.error("Failed to request data from DoubleVerify",t)}}handleResponse(e){const{ABS:t,BSC:r,IDS:s,TVP:a,VLP:d}=e;this.gptWrapper&&(this.gptWrapper.setTargeting("abs",t),this.gptWrapper.setTargeting("bsc",r),this.gptWrapper.setTargeting("ids",s.toString())),this.setTargetingForSlots("tvp",a),this.setTargetingForSlots("vlp",d)}setTargetingForSlots(e,t={}){for(const[r,s]of Object.entries(t)){const a=this.trackedSlots[r];a==null||a.setTargeting(e,s[""])}}initialize(){if(!this.consent||!this.gptWrapper||!this.adNodeManager||this.initialized)return;for(const[t,r]of Object.entries(vr))this.gptWrapper.setTargeting(t,r);const e=this.adNodeManager.getAdNodes();for(const t of e){if(!Ve.includes(t.getBaseSlotName())&&!Ve.includes(t.getSlotName()))continue;t.setTargeting("vlp",M),t.setTargeting("tvp",M);const r=t.getAdUnitPath();r?this.trackedSlots[r]=t:console.warn(`[DoubleVerifyPlugin] AdUnitPath for ${t.getSlotName()} not defined. Skipping slot`)}this.initialized=!0,this.fetchData()}}class Cr extends u{constructor(){super(...arguments);o(this,"gpt");o(this,"runInterstitialAd",e=>{const t=y.get("_ae_intrsttl_imp"),r=document.getElementById("interstitial_wrapper");if(!r||t)return;const s=r==null?void 0:r.querySelector("#interstitial");if(this.noInterstitial(s))return;const a=this.getValidLinkFromEvent(e);a&&(e.preventDefault(),this.showInterstitialOverlay(s,r),this.createAndAppendTopBar(r),this.configureAdBehavior(r,a.href))});o(this,"hooks",{onAdEngineInit:e=>{this.gpt=e.gptWrapper,(y.get("_ae_intrsttl_imp")||this.isPageReloaded())&&this.setInterstitialDisabledTargeting()},onBeforeFirstCallAdsRequest:e=>{const t=document.getElementById("interstitial_wrapper");t&&(t.classList.remove("show"),e.addEventListener("slotResponseReceived",r=>{const s=r.slot,a=s.getSlotElementId(),d=s.getResponseInformation();a==="interstitial"&&d&&(document.addEventListener("click",this.runInterstitialAd,!0),e.addEventListener("slotVisibilityChanged",c=>{c.slot.getSlotElementId()==="interstitial"&&this.setCappingCookieAndInterstitialDisabledTargeting()}))}))}});o(this,"api",{onCeltraInterstitialImpression:()=>{this.setCappingCookieAndInterstitialDisabledTargeting()}})}noInterstitial(e){return!e||!e.querySelector("div iframe")}ensureAnchorTagLinkIsValid(e){var t;return!!(e&&e.href&&!e.href.startsWith("javascript:")&&((t=e.hash)==null?void 0:t.length)===0&&!e.href.endsWith("#"))}getValidLinkFromEvent(e){const r=e.target.closest("a");return this.ensureAnchorTagLinkIsValid(r)?r:null}showInterstitialOverlay(e,t){t.classList.add("show"),e.classList.add("show")}createCloseButtonElement(e){const t=document.createElement("button");return t.innerHTML="×",t.className="interstitial-close-button",t.onclick=e,t}createAdLabelElement(){const e=document.createElement("div");return e.className="interstitial-ad-label",e.textContent="Ad",e}createAndAppendTopBar(e){let t=e.querySelector(".interstitial-top-bar");if(t)return;t=document.createElement("div"),t.className="interstitial-top-bar";const r=this.createAdLabelElement(),s=this.createCloseButtonElement(()=>{e&&e.classList.remove("show")});t.appendChild(r),t.appendChild(s),e.appendChild(t)}blockPageScroll(){document.body.classList.add("odyssey-interstitial")}unBlockPageScroll(){document.body.classList.remove("odyssey-interstitial")}configureAdBehavior(e,t){var r;this.blockPageScroll(),(r=this.gpt)==null||r.addEventListener("slotVisibilityChanged",s=>{s.slot.getSlotElementId()==="interstitial"&&s.inViewPercentage===0&&(e.classList.remove("show"),this.unBlockPageScroll(),window.location.href=t)})}isPageReloaded(){return window.performance?performance.getEntriesByType("navigation")[0].type==="reload":void 0}setCappingCookieAndInterstitialDisabledTargeting(){y.set("_ae_intrsttl_imp","1",{expires:864e5,domain:$e(),path:"/"}),this.setInterstitialDisabledTargeting()}setInterstitialDisabledTargeting(){if(this.gpt){const e=this.gpt.getTargeting("bundles")||[];e.push("interstitial_disabled"),this.gpt.setTargeting("bundles",e)}}}function Pr(i,n,e){return i===n&&e!==void 0&&e!==null}class Rr extends u{constructor(){super(...arguments);o(this,"JWP_RTD_AUCTION_DELAY",100);o(this,"hooks",{onBiddersInit:()=>{const e=this.usePlugin(_);e==null||e.addPrebidReadyCallback(t=>{t.mergeConfig(this.configureJwpRtd())})},onCreateBidderAdUnit:(e,t,r)=>{Pr("prebid",e,r)&&r.forEach(s=>{var a;(a=s.mediaTypes)!=null&&a.video&&(s.ortb2Imp=this.extendOrtbWithJwpRtdData(s.ortb2Imp))})}})}static isEnabled(e){var t;return!!((t=window.canPlayVideo)!=null&&t.call(window))&&e.icFeaturedVideoPlayer==="jwp-video-player"}configureJwpRtd(){const e=ke();if(!e)return{};const{mediaId:t}=e;return{realTimeData:{auctionDelay:this.JWP_RTD_AUCTION_DELAY,dataProviders:[{name:"jwplayer",waitForIt:!0,params:{mediaIDs:t?[t]:[]}}]}}}extendOrtbWithJwpRtdData(e={}){var r,s;const t=(r=ke())==null?void 0:r.mediaId;return t?{...e,ext:{...e.ext,data:{...((s=e.ext)==null?void 0:s.data)??{},jwTargeting:{mediaID:t}}}}:e}}const Nr="//cdn.adsafeprotected.com/iasPET.1.js",Lr="930616",Ge=["adt","alc","dlm","drg","hat","off","vio"],ze={veryLow:1,low:2,medium:3,high:4},je={default:[],fandomdesktop:["top_leaderboard","top_boxad","incontent_boxad","incontent_leaderboard","bottom_leaderboard","gallery_leaderboard","featured","incontent_player"],fandommobile:["top_leaderboard","top_boxad","incontent_boxad","bottom_leaderboard","featured","incontent_player","drawer"],f2:["top_leaderboard","top_boxad","incontent_boxad","bottom_leaderboard","featured"],comicvine:["mpu_top"],gamefaqs:["mpu_top"],gamespot:["mpu_top"],giantbomb:["mpu_top"],metacritic:["mpu_plus_top"],"metacritic-neutron":["mpu-plus-top"],tvguide:["mpu-plus-top"],sports:["cdm-zone-01","cdm-zone-02","cdm-zone-03","cdm-zone-04","cdm-zone-06"]};function St(i){return Array.isArray(i)?i.length===2&&typeof i[0]=="number"&&typeof i[1]=="number"?i:i.length===1&&i[0]==="fluid"?"fluid":Array.isArray(i[0])?St(i[0]):[1,1]:i==="fluid"?"fluid":[1,1]}class Or extends u{constructor(){super(...arguments);o(this,"gptWrapper");o(this,"adNodeManager");o(this,"consent",!1);o(this,"initialized",!1);o(this,"hooks",{onConsentUpdated:e=>{A(e)&&(this.consent=!0,this.initialize())},onAdEngineInit:e=>{this.adNodeManager=e.adNodeManager,this.gptWrapper=e.gptWrapper,this.initialize()}})}static isEnabled(e){return!!(e!=null&&e.icIASPublisherOptimization)}async initialize(){if(!(!this.consent||!this.gptWrapper||!this.adNodeManager||this.initialized))return I(Nr).then(()=>{this.setup(),this.initialized=!0})}setup(){this.setInitialTargeting(),window.__iasPET=window.__iasPET??{},window.__iasPET.queue=window.__iasPET.queue??[],window.__iasPET.pubId=Lr,window.__iasPET.queue.push({adSlots:this.getPETSlots(),dataHandler:this.iasDataHandler.bind(this)})}setInitialTargeting(){var e,t,r;(e=this.gptWrapper)==null||e.setTargeting("fr","-1"),(t=this.gptWrapper)==null||t.setTargeting("b_ias","-1"),(r=this.gptWrapper)==null||r.setTargeting("ias-kw","-1"),Ge.forEach(s=>{var a;(a=this.gptWrapper)==null||a.setTargeting(s,"-1")}),this.getWatchedAdNodes().forEach(s=>{s.setTargeting("vw","-1")})}getPETSlots(){const e=[];return this.getWatchedAdNodes().forEach(t=>{const r=this.getSlotSize(t),s={adUnitPath:t.getAdUnitPath()??"",adSlotId:t.getSlotName(),size:r};t.getSlotType()==="video"&&(s.type="video",s.size=[1,1]),e.push(s)}),e}getSlotSize(e){const{sizes:t}=e.getSlotConfig(),r=St(t);return Array.isArray(r)?r:[1,1]}getWatchedAdNodes(){var t;return(((t=this.adNodeManager)==null?void 0:t.getAdNodes())??[]).filter(r=>this.getWatchedSlotList().includes(r.getSlotName())||this.getWatchedSlotList().includes(r.getBaseSlotName()))}getWatchedSlotList(){return je[ee()]??je.default}iasDataHandler(e){try{const t=JSON.parse(e);this.updateGenericTargeting(t),this.updateSlotTargeting(t),this.updateBrandSafetyTargeting(t)}catch(t){console.error("Failed to parse IAS targeting data",t)}}updateGenericTargeting(e){var t,r;(t=this.gptWrapper)==null||t.setTargeting("fr",(e==null?void 0:e.fr)??""),e.custom&&e.custom["ias-kw"]&&((r=this.gptWrapper)==null||r.setTargeting("ias-kw",e.custom["ias-kw"]))}updateSlotTargeting(e){var t;if(e.slots)for(const[r,s]of Object.entries(e.slots))(t=this.gptWrapper)==null||t.setSlotTargeting(r,"vw",s.vw??s.vw_vv)}updateBrandSafetyTargeting(e){var t;if(e.brandSafety){const r=e.brandSafety;let s;Ge.forEach(a=>{var d;r[a]&&((d=this.gptWrapper)==null||d.setTargeting(a,r[a]),(typeof s>"u"||ze[s]<ze[r[a]])&&(s=r[a]))}),(t=this.gptWrapper)==null||t.setTargeting("b_ias",s??"-1")}}}function kr(){(function(i,n){i[n]=i[n]||{nlsQ:function(e,t,r,s,a,d){return a=i.document,s=a.createElement("script"),s.defer=1,s.src=(i.location.protocol==="http:"?"http:":"https:")+"//cdn-gl.imrworldwide.com/conf/"+e+".js#name="+t+"&ns="+n,d=a.getElementsByTagName("script")[0],d.parentNode.insertBefore(s,d),i[n][t]=i[n][t]||{g:r||{},ggPM:function(c,l,m,g,p){(i[n][t].q=i[n][t].q||[]).push([c,l,m,g,p])}},i[n][t]}}})(window,"NOLBUNDLE")}class Br extends u{constructor(){super();o(this,"NIELSEN_KEY","P26086A07-C7FB-4124-A679-8AC404198BA7");o(this,"nielsenWindowConfig",{});o(this,"isLoaded",!1);o(this,"gptWrapper");o(this,"consent",!1);o(this,"hooks",{onConsentUpdated:e=>{this.consent=A(e),this.consent&&this.init()},onAfterGptWrapperInit:e=>{this.gptWrapper=e,this.consent&&this.init()}})}static isEnabled({icNielsen:e}){return!!e}getNielsenInstance(){return kr(),x("nielsen-dcr-debug")&&(this.nielsenWindowConfig.nol_sdkDebug="debug"),window==null?void 0:window.NOLBUNDLE.nlsQ(this.NIELSEN_KEY,"nlsnInstance",this.nielsenWindowConfig)}init(){var d,c,l;if(this.isLoaded||!this.gptWrapper)return;const e=this.getNielsenInstance(),t=(d=this.gptWrapper.getTargeting("s0v"))==null?void 0:d.join(","),r=(c=this.gptWrapper.getTargeting("artid"))==null?void 0:c.join(","),s=(l=this.gptWrapper.getTargeting("s1"))==null?void 0:l.join(","),a={type:"static",assetid:`fandom.com/${t}/${s}/${r}`,section:`FANDOM ${t==null?void 0:t.replace(/_/g," ").toUpperCase()} NETWORK`};e.ggPM("static",a),this.isLoaded=!0}}const Z=class Z extends u{constructor(){super(...arguments);o(this,"isInitialized",!1);o(this,"hooks",{onConsentUpdated:e=>{A(e)&&this.initialize()}})}static isEnabled({icBlockthroughReadershipLink:e}){return!!e}async initialize(){if(!this.isInitialized){this.isInitialized=!0;try{await I(Z.SCRIPT_URL)}catch(e){console.warn("Failed to load BlockthroughReadershipLink script",e)}}}};o(Z,"SCRIPT_URL","https://btloader.com/tag?o=5199505043488768&upapi=true");let he=Z;class Dr extends u{constructor(){super();o(this,"translatedAdLabel");o(this,"excludedSlots",new Set(["top_leaderboard","floor_adhesion"]));o(this,"hooks",{onAdEngineInit:e=>{this.registerSlotRenderHandler(e.gptWrapper)}});const e=document.querySelector(".ae-translatable-label");this.translatedAdLabel=e instanceof HTMLElement?e:null}registerSlotRenderHandler(e){e.addEventListener("slotRenderEnded",t=>{const r=t.slot.getSlotElementId();if(this.excludedSlots.has(r))return;const s=document.getElementById(r);if(!s||!this.translatedAdLabel)return;const a=`label-${r}`;if(document.getElementById(a))return;const d=this.cloneTranslatedLabel(a);s.appendChild(d)})}cloneTranslatedLabel(e){const t=this.translatedAdLabel.cloneNode(!0);t.classList.remove("dsa-advertisement-label-clickable"),t.id=e;const r=t.querySelector(".dsa-advertisement-label-icon");return r==null||r.remove(),t}}class Fr extends u{constructor(e){super();o(this,"YAHOO_BIT",0);o(this,"ID5_BIT",1);o(this,"HEM_BIT",2);o(this,"LIVEINTENT_BIT",3);o(this,"PUBCID_BIT",4);o(this,"UID2_BIT",5);o(this,"BIT_PLACEHOLDER","x");o(this,"ID_STRING_LENGTH",16);o(this,"PRESENT_PLACEHOLDER","P");o(this,"ABSENT_PLACEHOLDER","A");o(this,"LIVE_CONNECT_PLACEHOLDER","L");o(this,"MEDIA_WIKI_PLACEHOLDER","M");o(this,"pbjs");o(this,"ID_MAP",{[this.YAHOO_BIT]:e=>this.getDefaultBitStatus(e,"yahoo.com"),[this.ID5_BIT]:e=>this.getDefaultBitStatus(e,"id5-sync.com"),[this.HEM_BIT]:()=>this.getHEMBitStatus(),[this.LIVEINTENT_BIT]:e=>this.getDefaultBitStatus(e,"liveintent.com"),[this.PUBCID_BIT]:e=>this.getDefaultBitStatus(e,"pubcid.org"),[this.UID2_BIT]:e=>this.getDefaultBitStatus(e,"uidapi.com")});o(this,"hooks",{onBiddersInit:e=>{var t;this.configureLiveIntentTargeting(e),(t=this.usePlugin(_))==null||t.addPrebidReadyCallback(r=>{this.pbjs=r,this.pbjs.onEvent("requestBids",()=>{this.generateBoiAndSyncGptTargeting(e),this.updateLiveIntentTargeting(e)})})}});this.config=e}getDefaultBitStatus(e,t){return e.find(r=>r.source===t)?this.PRESENT_PLACEHOLDER:this.ABSENT_PLACEHOLDER}getHEMBitStatus(){var e,t,r;switch(!0){case this.checkIfLiveConnectSha2HEMIsPresent():return this.LIVE_CONNECT_PLACEHOLDER;case!!((r=(t=(e=ot())==null?void 0:e.opts)==null?void 0:t.userEmailHashes)!=null&&r.length):return this.MEDIA_WIKI_PLACEHOLDER;default:return this.ABSENT_PLACEHOLDER}}configureLiveIntentTargeting(e){var s;const t=this.config.icLiveIntentConnectedId,r=t?"t1":"t0";if((s=e.gptWrapper)==null||s.setTargeting("li-module-enabled",[r]),!t){window.liModuleEnabled=!1;return}window.liModuleEnabled=!0}updateLiveIntentTargeting(e){var r;if(!this.config.icLiveIntentConnectedId)return;const t=this.getIds().some(s=>s.source.includes("liveintent.com"));(r=e.gptWrapper)==null||r.setTargeting("li-module-enabled",[`t1-${t?"e1":"e0"}`])}getIds(){var e;return((e=this.pbjs)==null?void 0:e.getUserIdsAsEids())??[]}generateBoiString(){const e=this.getIds();let t="";for(let r=0;r<this.ID_STRING_LENGTH;r++){const s=this.ID_MAP[r];if(s){const a=s(e);t+=a}else t+=this.BIT_PLACEHOLDER}return t}generateBoiAndSyncGptTargeting(e){const t=this.generateBoiString();e.gptWrapper.setTargeting("boi",t)}checkIfLiveConnectSha2HEMIsPresent(){var e;try{return((e=this.usePlugin(W))==null?void 0:e.checkIfHemAvailable())??!1}catch{return!1}}}class Mr extends u{constructor(){super(...arguments);o(this,"hooks",{onAdEngineInit:e=>{this.removeTlbPlaceholderClass(e.gptWrapper)}})}removeTlbPlaceholderClass(e){const t=r=>{var s;r.slot.getSlotElementId()==="top_leaderboard"&&((s=document.querySelector(".top-ads-container"))==null||s.classList.remove("tlb-placeholder"),e.removeEventListener("slotRenderEnded",t))};e.addEventListener("slotRenderEnded",t)}}function At(i,n){return i.filter(e=>e.isEnabled(n)).map(e=>new e(n))}function xr(i){return At([de,Qn,Tr,Er,mr,nr,yr,Or,fr,W,tr,Br,he],i)}function Ur(i){return At([Xn,_,Ai,Fr,Rr],i)}async function Wr(){const{config:i,activeLabradorKeyValues:n}=await qt(),e={ExampleExposedPlugin:new ni,InterstitialPlugin:new Cr,FloorAdhesionPlugin:new di,TopStrategyTunerPlugin:new Mi(i),VastUrlPlugin:new ge(i),LightboxLeaderboardPlugin:new er,InContentPlayerPlugin:new ft},r=[new Zi,new ti,...Object.values(e),new ct,new gi(n),new hi,new le(i),new Dr,new Ei,new Jn,new lt,new Mr,...Ur(i),...xr(i),...await Ht()],s=new Map(r.map(c=>[c.constructor,c]));r.forEach(c=>{c.setPlugins(s)}),performance.mark(b.AE_AFTER_INIT_PLUGINS);const a={flags:n};return f(Je.LABRADOR_KEYVALUES,a),(await ln(i,r)).start(),e}function Vr(i,n,...e){const t=document.createElement(i);return n&&Object.keys(n).forEach(r=>{r.startsWith("on")?t.addEventListener(r.slice(2).toLowerCase(),n[r]):r==="ref"?n[r].current=t:t[r]=n[r]}),t.append(...e.filter(r=>!!r)),t}window.jsxRenderer=Vr;function Gr(){typeof Promise.withResolvers!="function"&&(Promise.withResolvers=()=>{let i,n;return{promise:new Promise((t,r)=>{i=t,n=r}),resolve:i,reject:n}})}Gr();performance.mark(b.AE_FIRST_LINE_EXEC);Wr().then(i=>{var n;window.fandomAds=new Wt(i,(n=window.fandomAds)==null?void 0:n.cmd)}).catch(et);export{u as A,_ as P,Qe as U,S as _,x as a,$e as b,y as c,Zn as d,X as e,vi as f,Ke as g,j as h,h as i,Ti as j};
//# sourceMappingURL=main.js.map
